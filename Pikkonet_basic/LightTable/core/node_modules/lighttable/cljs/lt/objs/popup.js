// Compiled by ClojureScript 0.0-2138
goog.provide('lt.objs.popup');
goog.require('cljs.core');
goog.require('lt.util.dom');
goog.require('lt.objs.context');
goog.require('lt.objs.context');
goog.require('lt.util.dom');
goog.require('lt.objs.canvas');
goog.require('lt.objs.command');
goog.require('lt.objs.keyboard');
goog.require('lt.objs.canvas');
goog.require('lt.object');
goog.require('lt.object');
goog.require('lt.objs.command');
goog.require('lt.objs.keyboard');
lt.objs.popup._STAR_no_close_STAR_ = null;
lt.objs.popup.__BEH__on_click_destroy = (function __BEH__on_click_destroy(this$){return lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"close!","close!",3951350939));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","on-click-destroy","lt.objs.popup/on-click-destroy",4693561385),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__on_click_destroy,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"click","click",1108654330),null], null), null));
lt.objs.popup.__BEH__close_BANG_ = (function __BEH__close_BANG_(this$){lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"close","close",1108660586));
lt.object.destroy_BANG_.call(null,this$);
var temp__4090__auto__ = cljs.core.seq.call(null,lt.object.by_tag.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766)));if(temp__4090__auto__)
{var others = temp__4090__auto__;return lt.objs.context.in_BANG_.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766),cljs.core.last.call(null,others));
} else
{return lt.objs.context.out_BANG_.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766));
}
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","close!","lt.objs.popup/close!",4613970955),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__close_BANG_,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"close!","close!",3951350939),null], null), null));
lt.objs.popup.__BEH__refocus_on_close = (function __BEH__refocus_on_close(this$){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"tabs.focus-active","tabs.focus-active",2001074557));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","refocus-on-close","lt.objs.popup/refocus-on-close",2521298612),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__refocus_on_close,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"close","close",1108660586),null], null), null));
lt.objs.popup.__BEH__change_active_button = (function __BEH__change_active_button(this$,dir){var buttons = lt.util.dom.$$.call(null,".button",lt.object.__GT_content.call(null,this$));var button = cljs.core.mod.call(null,(new cljs.core.Keyword(null,"button","button",3931183780).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$)) + dir),cljs.core.count.call(null,buttons));lt.util.dom.remove_class.call(null,(buttons[new cljs.core.Keyword(null,"button","button",3931183780).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$))]),new cljs.core.Keyword(null,"active","active",3885920888));
lt.util.dom.add_class.call(null,(buttons[button]),new cljs.core.Keyword(null,"active","active",3885920888));
return lt.object.merge_BANG_.call(null,this$,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"button","button",3931183780),button], null));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","change-active-button","lt.objs.popup/change-active-button",2736197342),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__change_active_button,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"move-active","move-active",3635471348),null], null), null));
lt.objs.popup.__BEH__exec_active = (function __BEH__exec_active(this$){var buttons = lt.util.dom.$$.call(null,".button",lt.object.__GT_content.call(null,this$));return lt.util.dom.trigger.call(null,(buttons[new cljs.core.Keyword(null,"button","button",3931183780).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$))]),new cljs.core.Keyword(null,"click","click",1108654330));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","exec-active","lt.objs.popup/exec-active",1054217124),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.popup.__BEH__exec_active,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"exec-active","exec-active",533892916),null], null), null));
lt.objs.popup.remain_open = (function remain_open(){return lt.objs.popup._STAR_no_close_STAR_ = true;
});
lt.objs.popup.__GT_button = (function __GT_button(this$,p__10497){var map__10506 = p__10497;var map__10506__$1 = ((cljs.core.seq_QMARK_.call(null,map__10506))?cljs.core.apply.call(null,cljs.core.hash_map,map__10506):map__10506);var post_action = cljs.core.get.call(null,map__10506__$1,new cljs.core.Keyword(null,"post-action","post-action",4039331701));var action = cljs.core.get.call(null,map__10506__$1,new cljs.core.Keyword(null,"action","action",3885920680));var label = cljs.core.get.call(null,map__10506__$1,new cljs.core.Keyword(null,"label","label",1116631654));var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"li.button","li.button",2481585205),label], null));var seq__10507_10514 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (){var _STAR_no_close_STAR_10511 = lt.objs.popup._STAR_no_close_STAR_;try{lt.objs.popup._STAR_no_close_STAR_ = null;
if(cljs.core.fn_QMARK_.call(null,action))
{action.call(null);
} else
{}
if(cljs.core.truth_(lt.objs.popup._STAR_no_close_STAR_))
{} else
{lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"close!","close!",3951350939));
}
if(cljs.core.fn_QMARK_.call(null,post_action))
{return post_action.call(null);
} else
{return null;
}
}finally {lt.objs.popup._STAR_no_close_STAR_ = _STAR_no_close_STAR_10511;
}})], null)));var chunk__10508_10515 = null;var count__10509_10516 = 0;var i__10510_10517 = 0;while(true){
if((i__10510_10517 < count__10509_10516))
{var vec__10512_10518 = cljs.core._nth.call(null,chunk__10508_10515,i__10510_10517);var ev__4336__auto___10519 = cljs.core.nth.call(null,vec__10512_10518,0,null);var func__4337__auto___10520 = cljs.core.nth.call(null,vec__10512_10518,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10519,func__4337__auto___10520);
{
var G__10521 = seq__10507_10514;
var G__10522 = chunk__10508_10515;
var G__10523 = count__10509_10516;
var G__10524 = (i__10510_10517 + 1);
seq__10507_10514 = G__10521;
chunk__10508_10515 = G__10522;
count__10509_10516 = G__10523;
i__10510_10517 = G__10524;
continue;
}
} else
{var temp__4092__auto___10525 = cljs.core.seq.call(null,seq__10507_10514);if(temp__4092__auto___10525)
{var seq__10507_10526__$1 = temp__4092__auto___10525;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10507_10526__$1))
{var c__4150__auto___10527 = cljs.core.chunk_first.call(null,seq__10507_10526__$1);{
var G__10528 = cljs.core.chunk_rest.call(null,seq__10507_10526__$1);
var G__10529 = c__4150__auto___10527;
var G__10530 = cljs.core.count.call(null,c__4150__auto___10527);
var G__10531 = 0;
seq__10507_10514 = G__10528;
chunk__10508_10515 = G__10529;
count__10509_10516 = G__10530;
i__10510_10517 = G__10531;
continue;
}
} else
{var vec__10513_10532 = cljs.core.first.call(null,seq__10507_10526__$1);var ev__4336__auto___10533 = cljs.core.nth.call(null,vec__10513_10532,0,null);var func__4337__auto___10534 = cljs.core.nth.call(null,vec__10513_10532,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10533,func__4337__auto___10534);
{
var G__10535 = cljs.core.next.call(null,seq__10507_10526__$1);
var G__10536 = null;
var G__10537 = 0;
var G__10538 = 0;
seq__10507_10514 = G__10535;
chunk__10508_10515 = G__10536;
count__10509_10516 = G__10537;
i__10510_10517 = G__10538;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.popup.popup_content = (function popup_content(this$,opts){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",1013907516),new cljs.core.Keyword(null,"header","header",4087600639).cljs$core$IFn$_invoke$arity$1(opts)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"p","p",1013904354),new cljs.core.Keyword(null,"body","body",1016933652).cljs$core$IFn$_invoke$arity$1(opts)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"ul.buttons","ul.buttons",666323612),(function (){var iter__4119__auto__ = (function iter__10549(s__10550){return (new cljs.core.LazySeq(null,(function (){var s__10550__$1 = s__10550;while(true){
var temp__4092__auto__ = cljs.core.seq.call(null,s__10550__$1);if(temp__4092__auto__)
{var s__10550__$2 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,s__10550__$2))
{var c__4117__auto__ = cljs.core.chunk_first.call(null,s__10550__$2);var size__4118__auto__ = cljs.core.count.call(null,c__4117__auto__);var b__10552 = cljs.core.chunk_buffer.call(null,size__4118__auto__);if((function (){var i__10551 = 0;while(true){
if((i__10551 < size__4118__auto__))
{var b = cljs.core._nth.call(null,c__4117__auto__,i__10551);cljs.core.chunk_append.call(null,b__10552,lt.objs.popup.__GT_button.call(null,this$,b));
{
var G__10559 = (i__10551 + 1);
i__10551 = G__10559;
continue;
}
} else
{return true;
}
break;
}
})())
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__10552),iter__10549.call(null,cljs.core.chunk_rest.call(null,s__10550__$2)));
} else
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__10552),null);
}
} else
{var b = cljs.core.first.call(null,s__10550__$2);return cljs.core.cons.call(null,lt.objs.popup.__GT_button.call(null,this$,b),iter__10549.call(null,cljs.core.rest.call(null,s__10550__$2)));
}
} else
{return null;
}
break;
}
}),null,null));
});return iter__4119__auto__.call(null,cljs.core.reverse.call(null,new cljs.core.Keyword(null,"buttons","buttons",1255256819).cljs$core$IFn$_invoke$arity$1(opts)));
})()], null)], null)], null));var seq__10553_10560 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (e){lt.util.dom.prevent.call(null,e);
return lt.util.dom.stop_propagation.call(null,e);
})], null)));var chunk__10554_10561 = null;var count__10555_10562 = 0;var i__10556_10563 = 0;while(true){
if((i__10556_10563 < count__10555_10562))
{var vec__10557_10564 = cljs.core._nth.call(null,chunk__10554_10561,i__10556_10563);var ev__4336__auto___10565 = cljs.core.nth.call(null,vec__10557_10564,0,null);var func__4337__auto___10566 = cljs.core.nth.call(null,vec__10557_10564,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10565,func__4337__auto___10566);
{
var G__10567 = seq__10553_10560;
var G__10568 = chunk__10554_10561;
var G__10569 = count__10555_10562;
var G__10570 = (i__10556_10563 + 1);
seq__10553_10560 = G__10567;
chunk__10554_10561 = G__10568;
count__10555_10562 = G__10569;
i__10556_10563 = G__10570;
continue;
}
} else
{var temp__4092__auto___10571 = cljs.core.seq.call(null,seq__10553_10560);if(temp__4092__auto___10571)
{var seq__10553_10572__$1 = temp__4092__auto___10571;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10553_10572__$1))
{var c__4150__auto___10573 = cljs.core.chunk_first.call(null,seq__10553_10572__$1);{
var G__10574 = cljs.core.chunk_rest.call(null,seq__10553_10572__$1);
var G__10575 = c__4150__auto___10573;
var G__10576 = cljs.core.count.call(null,c__4150__auto___10573);
var G__10577 = 0;
seq__10553_10560 = G__10574;
chunk__10554_10561 = G__10575;
count__10555_10562 = G__10576;
i__10556_10563 = G__10577;
continue;
}
} else
{var vec__10558_10578 = cljs.core.first.call(null,seq__10553_10572__$1);var ev__4336__auto___10579 = cljs.core.nth.call(null,vec__10558_10578,0,null);var func__4337__auto___10580 = cljs.core.nth.call(null,vec__10558_10578,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10579,func__4337__auto___10580);
{
var G__10581 = cljs.core.next.call(null,seq__10553_10572__$1);
var G__10582 = null;
var G__10583 = 0;
var G__10584 = 0;
seq__10553_10560 = G__10581;
chunk__10554_10561 = G__10582;
count__10555_10562 = G__10583;
i__10556_10563 = G__10584;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.popup.popup = (function popup(this$,opts){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.popup","div.popup",2038588545),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"tabindex","tabindex",4410954191),-1], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),lt.objs.popup.popup_content.call(null,this$,opts)], null)], null));var seq__10591_10597 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (){return lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"click","click",1108654330));
})], null)));var chunk__10592_10598 = null;var count__10593_10599 = 0;var i__10594_10600 = 0;while(true){
if((i__10594_10600 < count__10593_10599))
{var vec__10595_10601 = cljs.core._nth.call(null,chunk__10592_10598,i__10594_10600);var ev__4336__auto___10602 = cljs.core.nth.call(null,vec__10595_10601,0,null);var func__4337__auto___10603 = cljs.core.nth.call(null,vec__10595_10601,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10602,func__4337__auto___10603);
{
var G__10604 = seq__10591_10597;
var G__10605 = chunk__10592_10598;
var G__10606 = count__10593_10599;
var G__10607 = (i__10594_10600 + 1);
seq__10591_10597 = G__10604;
chunk__10592_10598 = G__10605;
count__10593_10599 = G__10606;
i__10594_10600 = G__10607;
continue;
}
} else
{var temp__4092__auto___10608 = cljs.core.seq.call(null,seq__10591_10597);if(temp__4092__auto___10608)
{var seq__10591_10609__$1 = temp__4092__auto___10608;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10591_10609__$1))
{var c__4150__auto___10610 = cljs.core.chunk_first.call(null,seq__10591_10609__$1);{
var G__10611 = cljs.core.chunk_rest.call(null,seq__10591_10609__$1);
var G__10612 = c__4150__auto___10610;
var G__10613 = cljs.core.count.call(null,c__4150__auto___10610);
var G__10614 = 0;
seq__10591_10597 = G__10611;
chunk__10592_10598 = G__10612;
count__10593_10599 = G__10613;
i__10594_10600 = G__10614;
continue;
}
} else
{var vec__10596_10615 = cljs.core.first.call(null,seq__10591_10609__$1);var ev__4336__auto___10616 = cljs.core.nth.call(null,vec__10596_10615,0,null);var func__4337__auto___10617 = cljs.core.nth.call(null,vec__10596_10615,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10616,func__4337__auto___10617);
{
var G__10618 = cljs.core.next.call(null,seq__10591_10609__$1);
var G__10619 = null;
var G__10620 = 0;
var G__10621 = 0;
seq__10591_10597 = G__10618;
chunk__10592_10598 = G__10619;
count__10593_10599 = G__10620;
i__10594_10600 = G__10621;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.object.object_STAR_.call(null,new cljs.core.Keyword("lt.objs.popup","popup","lt.objs.popup/popup",767372430),new cljs.core.Keyword(null,"tags","tags",1017456523),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"popup","popup",1120756766),null], null), null),new cljs.core.Keyword(null,"button","button",3931183780),0,new cljs.core.Keyword(null,"init","init",1017141378),(function (this$,content){return lt.objs.popup.popup.call(null,this$,content);
}));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"popup.exec-active","popup.exec-active",2113737970),new cljs.core.Keyword(null,"desc","desc",1016984067),"Popup: execute active option",new cljs.core.Keyword(null,"hidden","hidden",4091384092),true,new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){var temp__4092__auto__ = lt.objs.context.__GT_obj.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766));if(cljs.core.truth_(temp__4092__auto__))
{var p = temp__4092__auto__;return lt.object.raise.call(null,p,new cljs.core.Keyword(null,"exec-active","exec-active",533892916));
} else
{return null;
}
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"popup.move-active","popup.move-active",920349106),new cljs.core.Keyword(null,"desc","desc",1016984067),"Popup: move selection",new cljs.core.Keyword(null,"hidden","hidden",4091384092),true,new cljs.core.Keyword(null,"exec","exec",1017031683),(function (dir){var temp__4092__auto__ = lt.objs.context.__GT_obj.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766));if(cljs.core.truth_(temp__4092__auto__))
{var p = temp__4092__auto__;return lt.object.raise.call(null,p,new cljs.core.Keyword(null,"move-active","move-active",3635471348),dir);
} else
{return null;
}
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"popup.escape","popup.escape",1937231733),new cljs.core.Keyword(null,"desc","desc",1016984067),"Popup: escape",new cljs.core.Keyword(null,"hidden","hidden",4091384092),true,new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){var temp__4092__auto__ = lt.objs.context.__GT_obj.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766));if(cljs.core.truth_(temp__4092__auto__))
{var p = temp__4092__auto__;return lt.object.raise.call(null,p,new cljs.core.Keyword(null,"click","click",1108654330));
} else
{return null;
}
})], null));
lt.objs.popup.popup_BANG_ = (function popup_BANG_(options){var p = lt.object.create.call(null,new cljs.core.Keyword("lt.objs.popup","popup","lt.objs.popup/popup",767372430),options);lt.object.raise.call(null,p,new cljs.core.Keyword(null,"move-active","move-active",3635471348),0);
lt.util.dom.append.call(null,lt.util.dom.$.call(null,new cljs.core.Keyword(null,"body","body",1016933652)),lt.object.__GT_content.call(null,p));
lt.object.__GT_content.call(null,p).focus();
lt.objs.context.in_BANG_.call(null,new cljs.core.Keyword(null,"popup","popup",1120756766),p);
return p;
});
lt.objs.popup.cancel_button = new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"label","label",1116631654),"cancel",new cljs.core.Keyword(null,"action","action",3885920680),new cljs.core.Keyword(null,"cancel","cancel",3941147116)], null);
