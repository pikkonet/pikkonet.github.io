// Compiled by ClojureScript 0.0-2138
goog.provide('lt.objs.settings');
goog.require('cljs.core');
goog.require('lt.util.cljs');
goog.require('lt.objs.app');
goog.require('lt.objs.sidebar.command');
goog.require('lt.objs.files');
goog.require('lt.util.dom');
goog.require('lt.objs.tabs');
goog.require('lt.objs.editor.pool');
goog.require('cljs.reader');
goog.require('lt.objs.workspace');
goog.require('lt.objs.notifos');
goog.require('lt.objs.notifos');
goog.require('lt.objs.workspace');
goog.require('lt.util.dom');
goog.require('lt.objs.editor.pool');
goog.require('clojure.string');
goog.require('lt.util.cljs');
goog.require('lt.objs.command');
goog.require('lt.objs.files');
goog.require('lt.objs.app');
goog.require('clojure.string');
goog.require('lt.objs.sidebar.command');
goog.require('lt.objs.editor');
goog.require('lt.object');
goog.require('cljs.reader');
goog.require('lt.object');
goog.require('lt.objs.console');
goog.require('lt.objs.tabs');
goog.require('lt.objs.editor');
goog.require('lt.objs.console');
goog.require('lt.objs.keyboard');
goog.require('lt.objs.command');
goog.require('lt.objs.keyboard');
lt.objs.settings.safe_read = (function safe_read(s,file){if(cljs.core.truth_(s))
{try{return cljs.reader.read_string.call(null,s);
}catch (e10946){if((e10946 instanceof global.Error))
{var e = e10946;lt.objs.console.error.call(null,[cljs.core.str("Invalid settings file: "),cljs.core.str(file),cljs.core.str("\n"),cljs.core.str(e)].join(''));
return null;
} else
{if((e10946 instanceof Error))
{var e = e10946;lt.objs.console.error.call(null,[cljs.core.str("Invalid settings file: "),cljs.core.str(file),cljs.core.str("\n"),cljs.core.str(e)].join(''));
return null;
} else
{if(new cljs.core.Keyword(null,"else","else",1017020587))
{throw e10946;
} else
{return null;
}
}
}
}} else
{return null;
}
});
lt.objs.settings._PLUS_behaviors = (function _PLUS_behaviors(cur,m){return cljs.core.assoc.call(null,cur,new cljs.core.Keyword(null,"+","+",1013904285),cljs.core.reduce.call(null,(function (res,p__10950){var vec__10951 = p__10950;var k = cljs.core.nth.call(null,vec__10951,0,null);var v = cljs.core.nth.call(null,vec__10951,1,null);return cljs.core.update_in.call(null,res,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [k], null),(function (p1__10947_SHARP_){return cljs.core.apply.call(null,cljs.core.conj,(function (){var or__3408__auto__ = p1__10947_SHARP_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.List.EMPTY;
}
})(),v);
}));
}),new cljs.core.Keyword(null,"+","+",1013904285).cljs$core$IFn$_invoke$arity$1(cur),m));
});
lt.objs.settings._behaviors = (function _behaviors(cur,m){return cljs.core.assoc.call(null,cur,new cljs.core.Keyword(null,"+","+",1013904285),cljs.core.reduce.call(null,(function (res,p__10958){var vec__10959 = p__10958;var k = cljs.core.nth.call(null,vec__10959,0,null);var v = cljs.core.nth.call(null,vec__10959,1,null);return cljs.core.update_in.call(null,res,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [k], null),(function (p1__10952_SHARP_){return cljs.core.remove.call(null,cljs.core.set.call(null,v),p1__10952_SHARP_);
}));
}),new cljs.core.Keyword(null,"+","+",1013904285).cljs$core$IFn$_invoke$arity$1(cur),m),new cljs.core.Keyword(null,"-","-",1013904287),cljs.core.reduce.call(null,(function (res,p__10960){var vec__10961 = p__10960;var k = cljs.core.nth.call(null,vec__10961,0,null);var v = cljs.core.nth.call(null,vec__10961,1,null);return cljs.core.update_in.call(null,res,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [k], null),(function (p1__10953_SHARP_){return cljs.core.apply.call(null,cljs.core.conj,(function (){var or__3408__auto__ = p1__10953_SHARP_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.List.EMPTY;
}
})(),v);
}));
}),new cljs.core.Keyword(null,"-","-",1013904287).cljs$core$IFn$_invoke$arity$1(cur),m));
});
lt.objs.settings.behavior_diff = (function behavior_diff(p__10962,final$){var map__10964 = p__10962;var map__10964__$1 = ((cljs.core.seq_QMARK_.call(null,map__10964))?cljs.core.apply.call(null,cljs.core.hash_map,map__10964):map__10964);var diff = map__10964__$1;var add = cljs.core.get.call(null,map__10964__$1,new cljs.core.Keyword(null,"+","+",1013904285));var rem = cljs.core.get.call(null,map__10964__$1,new cljs.core.Keyword(null,"-","-",1013904287));if(cljs.core.not.call(null,diff))
{return final$;
} else
{return lt.objs.settings._behaviors.call(null,lt.objs.settings._PLUS_behaviors.call(null,final$,add),rem);
}
});
lt.objs.settings.reverse_diff = (function reverse_diff(p__10965){var map__10967 = p__10965;var map__10967__$1 = ((cljs.core.seq_QMARK_.call(null,map__10967))?cljs.core.apply.call(null,cljs.core.hash_map,map__10967):map__10967);var add = cljs.core.get.call(null,map__10967__$1,new cljs.core.Keyword(null,"+","+",1013904285));var rem = cljs.core.get.call(null,map__10967__$1,new cljs.core.Keyword(null,"-","-",1013904287));return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"+","+",1013904285),rem,new cljs.core.Keyword(null,"-","-",1013904287),add], null);
});
lt.objs.settings.apply_diff = (function apply_diff(diff){return cljs.core.reset_BANG_.call(null,lt.object.tags,lt.objs.settings.behavior_diff.call(null,diff,cljs.core.deref.call(null,lt.object.tags)));
});
lt.objs.settings.parse_file = (function parse_file(file,final$){return lt.objs.settings.safe_read.call(null,new cljs.core.Keyword(null,"content","content",1965434859).cljs$core$IFn$_invoke$arity$1(lt.objs.files.open_sync.call(null,file)),file);
});
lt.objs.settings.behavior_diffs_in = (function behavior_diffs_in(path){if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,path)))
{return cljs.core.mapv.call(null,lt.objs.settings.parse_file,cljs.core.filter.call(null,(function (p1__10968_SHARP_){return cljs.core._EQ_.call(null,lt.objs.files.ext.call(null,p1__10968_SHARP_),"behaviors");
}),lt.objs.files.full_path_ls.call(null,path)));
} else
{return null;
}
});
lt.objs.settings.load_all = (function load_all(){var final$ = cljs.core.reduce.call(null,(function (fin,cur){return lt.objs.settings.behavior_diff.call(null,cur,fin);
}),cljs.core.PersistentArrayMap.EMPTY,cljs.core.concat.call(null,lt.object.raise_reduce.call(null,lt.objs.app.app,new cljs.core.Keyword(null,"behaviors.diffs.default+","behaviors.diffs.default+",556712841),cljs.core.PersistentVector.EMPTY),lt.object.raise_reduce.call(null,lt.objs.app.app,new cljs.core.Keyword(null,"behaviors.diffs.plugin+","behaviors.diffs.plugin+",2303858461),cljs.core.PersistentVector.EMPTY),lt.object.raise_reduce.call(null,lt.objs.app.app,new cljs.core.Keyword(null,"behaviors.diffs.user+","behaviors.diffs.user+",707208773),cljs.core.PersistentVector.EMPTY)));var ws_diff = new cljs.core.Keyword(null,"ws-behaviors","ws-behaviors",2339346978).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.workspace.current_ws));var final$__$1 = (cljs.core.truth_((function (){var and__3396__auto__ = ws_diff;if(cljs.core.truth_(and__3396__auto__))
{return !(cljs.core.empty_QMARK_.call(null,ws_diff));
} else
{return and__3396__auto__;
}
})())?lt.objs.settings.behavior_diff.call(null,lt.objs.settings.safe_read.call(null,ws_diff,"workspace.behaviors"),final$):final$);cljs.core.reset_BANG_.call(null,lt.object.negated_tags,(function (){var or__3408__auto__ = new cljs.core.Keyword(null,"-","-",1013904287).cljs$core$IFn$_invoke$arity$1(final$__$1);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.PersistentArrayMap.EMPTY;
}
})());
return cljs.core.reset_BANG_.call(null,lt.object.tags,(function (){var or__3408__auto__ = new cljs.core.Keyword(null,"+","+",1013904285).cljs$core$IFn$_invoke$arity$1(final$__$1);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.PersistentArrayMap.EMPTY;
}
})());
});
lt.objs.settings.refresh_diffed = (function refresh_diffed(diff){return lt.objs.settings.refresh_all.call(null,cljs.core.mapcat.call(null,lt.object.by_tag,cljs.core.concat.call(null,cljs.core.keys.call(null,new cljs.core.Keyword(null,"+","+",1013904285).cljs$core$IFn$_invoke$arity$1(diff)),cljs.core.keys.call(null,new cljs.core.Keyword(null,"-","-",1013904287).cljs$core$IFn$_invoke$arity$1(diff)))));
});
lt.objs.settings.refresh_all = (function refresh_all(objs){if(cljs.core.not.call(null,cljs.core.seq.call(null,objs)))
{lt.object.raise.call(null,lt.objs.app.app,new cljs.core.Keyword(null,"behaviors.refreshed","behaviors.refreshed",1338765023));
return lt.objs.notifos.done_working.call(null,"Behaviors loaded");
} else
{try{lt.object.refresh_BANG_.call(null,cljs.core.first.call(null,objs));
}catch (e10970){if((e10970 instanceof global.Error))
{var e_10971 = e10970;console.error(e_10971);
} else
{if((e10970 instanceof Error))
{var e_10972 = e10970;console.error(e_10972);
} else
{if(new cljs.core.Keyword(null,"else","else",1017020587))
{throw e10970;
} else
{}
}
}
}return process.nextTick((function (){return refresh_all.call(null,cljs.core.next.call(null,objs));
}));
}
});
lt.objs.settings.__BEH__default_behavior_diffs = (function __BEH__default_behavior_diffs(this$,diffs){return cljs.core.concat.call(null,diffs,lt.objs.settings.behavior_diffs_in.call(null,lt.objs.files.lt_home.call(null,"settings/default/")));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","default-behavior-diffs","lt.objs.settings/default-behavior-diffs",3478385645),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__default_behavior_diffs,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"behaviors.diffs.default+","behaviors.diffs.default+",556712841),null], null), null));
lt.objs.settings.__BEH__user_behavior_diffs = (function __BEH__user_behavior_diffs(this$,diffs){return cljs.core.concat.call(null,diffs,lt.objs.settings.behavior_diffs_in.call(null,lt.objs.files.lt_user_dir.call(null,"settings/")));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","user-behavior-diffs","lt.objs.settings/user-behavior-diffs",2390870839),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__user_behavior_diffs,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"behaviors.diffs.user+","behaviors.diffs.user+",707208773),null], null), null));
lt.objs.settings.__BEH__initial_behaviors = (function __BEH__initial_behaviors(this$){if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,lt.objs.files.lt_user_dir.call(null,"settings"))))
{} else
{lt.objs.files.mkdir.call(null,lt.objs.files.lt_user_dir.call(null,"settings"));
}
lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"pre-load","pre-load",3967767874));
lt.objs.settings.load_all.call(null);
var seq__10977_10981 = cljs.core.seq.call(null,cljs.core.vals.call(null,cljs.core.deref.call(null,lt.object.instances)));var chunk__10978_10982 = null;var count__10979_10983 = 0;var i__10980_10984 = 0;while(true){
if((i__10980_10984 < count__10979_10983))
{var inst_10985 = cljs.core._nth.call(null,chunk__10978_10982,i__10980_10984);lt.object.refresh_BANG_.call(null,inst_10985);
{
var G__10986 = seq__10977_10981;
var G__10987 = chunk__10978_10982;
var G__10988 = count__10979_10983;
var G__10989 = (i__10980_10984 + 1);
seq__10977_10981 = G__10986;
chunk__10978_10982 = G__10987;
count__10979_10983 = G__10988;
i__10980_10984 = G__10989;
continue;
}
} else
{var temp__4092__auto___10990 = cljs.core.seq.call(null,seq__10977_10981);if(temp__4092__auto___10990)
{var seq__10977_10991__$1 = temp__4092__auto___10990;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10977_10991__$1))
{var c__4150__auto___10992 = cljs.core.chunk_first.call(null,seq__10977_10991__$1);{
var G__10993 = cljs.core.chunk_rest.call(null,seq__10977_10991__$1);
var G__10994 = c__4150__auto___10992;
var G__10995 = cljs.core.count.call(null,c__4150__auto___10992);
var G__10996 = 0;
seq__10977_10981 = G__10993;
chunk__10978_10982 = G__10994;
count__10979_10983 = G__10995;
i__10980_10984 = G__10996;
continue;
}
} else
{var inst_10997 = cljs.core.first.call(null,seq__10977_10991__$1);lt.object.refresh_BANG_.call(null,inst_10997);
{
var G__10998 = cljs.core.next.call(null,seq__10977_10991__$1);
var G__10999 = null;
var G__11000 = 0;
var G__11001 = 0;
seq__10977_10981 = G__10998;
chunk__10978_10982 = G__10999;
count__10979_10983 = G__11000;
i__10980_10984 = G__11001;
continue;
}
}
} else
{}
}
break;
}
lt.objs.settings.load_all_keys.call(null);
return lt.objs.keyboard.refresh.call(null);
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","initial-behaviors","lt.objs.settings/initial-behaviors",1554007604),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__initial_behaviors,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"pre-init","pre-init",3967677804),null], null), null));
lt.objs.settings.__BEH__load_behaviors = (function __BEH__load_behaviors(this$){lt.objs.notifos.working.call(null,"loading behaviors...");
lt.objs.settings.load_all.call(null);
return lt.objs.settings.refresh_all.call(null,cljs.core.vals.call(null,cljs.core.deref.call(null,lt.object.instances)));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","load-behaviors","lt.objs.settings/load-behaviors",1077508690),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__load_behaviors,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600),null], null), null));
lt.objs.settings.__BEH__eval_settings = (function __BEH__eval_settings(ed){return lt.object.raise.call(null,ed,new cljs.core.Keyword(null,"save","save",1017427183));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","eval-settings","lt.objs.settings/eval-settings",3832502360),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__eval_settings,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"eval.one","eval.one",1173589382),null,new cljs.core.Keyword(null,"eval","eval",1017029646),null], null), null));
lt.objs.settings.__BEH__grab_workspace_behaviors = (function __BEH__grab_workspace_behaviors(workspace,old){var old__$1 = new cljs.core.Keyword(null,"ws-behaviors","ws-behaviors",2339346978).cljs$core$IFn$_invoke$arity$1(old);var old__$2 = ((cljs.core.empty_QMARK_.call(null,old__$1))?null:cljs.reader.read_string.call(null,old__$1));var neue = new cljs.core.Keyword(null,"ws-behaviors","ws-behaviors",2339346978).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,workspace));var neue__$1 = ((cljs.core.empty_QMARK_.call(null,neue))?null:cljs.reader.read_string.call(null,neue));if(cljs.core.truth_(old__$2))
{lt.objs.settings.apply_diff.call(null,lt.objs.settings.reverse_diff.call(null,old__$2));
lt.objs.settings.refresh_diffed.call(null,old__$2);
} else
{}
if(cljs.core.truth_(neue__$1))
{lt.objs.settings.apply_diff.call(null,neue__$1);
return lt.objs.settings.refresh_diffed.call(null,neue__$1);
} else
{return null;
}
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","grab-workspace-behaviors","lt.objs.settings/grab-workspace-behaviors",3638576708),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__grab_workspace_behaviors,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"set","set",1014018004),null], null), null));
lt.objs.settings.__BEH__workspace_save = (function __BEH__workspace_save(editor){var map__11003 = cljs.core.deref.call(null,editor).call(null,new cljs.core.Keyword(null,"info","info",1017141280));var map__11003__$1 = ((cljs.core.seq_QMARK_.call(null,map__11003))?cljs.core.apply.call(null,cljs.core.hash_map,map__11003):map__11003);var path = cljs.core.get.call(null,map__11003__$1,new cljs.core.Keyword(null,"path","path",1017337751));var final$ = lt.object.raise_reduce.call(null,editor,new cljs.core.Keyword(null,"save+","save+",1123115456),lt.objs.editor.__GT_val.call(null,editor));lt.object.merge_BANG_.call(null,lt.objs.workspace.current_ws,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"ws-behaviors","ws-behaviors",2339346978),final$], null));
lt.object.merge_BANG_.call(null,editor,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"dirty","dirty",1109497668),false], null));
lt.object.raise.call(null,editor,new cljs.core.Keyword(null,"saved","saved",1123115513));
lt.object.raise.call(null,editor,new cljs.core.Keyword(null,"clean","clean",1108650427));
return lt.object.raise.call(null,lt.objs.workspace.current_ws,new cljs.core.Keyword(null,"serialize!","serialize!",4710885555));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","workspace-save","lt.objs.settings/workspace-save",3431155415),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__workspace_save,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"save","save",1017427183),null], null), null));
lt.objs.settings.user_behaviors_path = lt.objs.files.lt_user_dir.call(null,"settings/user.behaviors");
lt.objs.settings.user_keymap_path = lt.objs.files.lt_user_dir.call(null,"settings/user.keymap");
lt.objs.settings.__BEH__create_user_settings = (function __BEH__create_user_settings(app){if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,lt.objs.settings.user_behaviors_path)))
{} else
{lt.objs.files.copy.call(null,lt.objs.files.lt_home.call(null,"/core/misc/example.behaviors"),lt.objs.settings.user_behaviors_path);
}
if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,lt.objs.settings.user_keymap_path)))
{return null;
} else
{return lt.objs.files.copy.call(null,lt.objs.files.lt_home.call(null,"/core/misc/example.keymap"),lt.objs.settings.user_keymap_path);
}
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","create-user-settings","lt.objs.settings/create-user-settings",1774305784),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__create_user_settings,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"init","init",1017141378),null], null), null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600),new cljs.core.Keyword(null,"desc","desc",1016984067),"App: Reload behaviors",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){return lt.object.raise.call(null,cljs.core.first.call(null,lt.object.by_tag.call(null,new cljs.core.Keyword(null,"app","app",1014001043))),new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600));
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"keymaps.reload","keymaps.reload",666881155),new cljs.core.Keyword(null,"desc","desc",1016984067),"App: Reload keymaps",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){lt.objs.settings.load_all_keys.call(null);
lt.objs.keyboard.refresh.call(null);
lt.object.raise.call(null,cljs.core.first.call(null,lt.object.by_tag.call(null,new cljs.core.Keyword(null,"app","app",1014001043))),new cljs.core.Keyword(null,"app.keys.load","app.keys.load",3209213061));
return lt.objs.notifos.set_msg_BANG_.call(null,"keys loaded");
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"behaviors.modify-user","behaviors.modify-user",4216959587),new cljs.core.Keyword(null,"desc","desc",1016984067),"Settings: User behaviors",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"open-path","open-path",2513940794),lt.objs.settings.user_behaviors_path);
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"behaviors.view-default","behaviors.view-default",4722027256),new cljs.core.Keyword(null,"desc","desc",1016984067),"Settings: Default behaviors",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"open-path","open-path",2513940794),lt.objs.files.lt_home.call(null,"/settings/default/default.behaviors"));
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"behaviors.modify-workspace","behaviors.modify-workspace",1192694945),new cljs.core.Keyword(null,"desc","desc",1016984067),"Settings: Workspace behaviors",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"opener.open-info","opener.open-info",2298471692),new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,"path","path",1017337751),"workspace.behaviors",new cljs.core.Keyword(null,"mime","mime",1017255846),"text/x-clojure",new cljs.core.Keyword(null,"name","name",1017277949),"workspace.behaviors",new cljs.core.Keyword(null,"tags","tags",1017456523),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"editor.behaviors","editor.behaviors",2095045778),new cljs.core.Keyword(null,"editor.behaviors.workspace","editor.behaviors.workspace",2607887545)], null),new cljs.core.Keyword(null,"content","content",1965434859),new cljs.core.Keyword(null,"ws-behaviors","ws-behaviors",2339346978).cljs$core$IFn$_invoke$arity$2(cljs.core.deref.call(null,lt.objs.workspace.current_ws),"")], null));
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"keymap.modify-user","keymap.modify-user",625546911),new cljs.core.Keyword(null,"desc","desc",1016984067),"Settings: User keymap",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"open-path","open-path",2513940794),lt.objs.settings.user_keymap_path);
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"keymap.view-default","keymap.view-default",762416700),new cljs.core.Keyword(null,"desc","desc",1016984067),"Settings: Default keymap",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"open-path","open-path",2513940794),lt.objs.files.lt_home.call(null,"/settings/default/default.keymap"));
})], null));
lt.objs.settings.__BEH__on_close_remove = (function __BEH__on_close_remove(this$){return lt.objs.tabs.rem_BANG_.call(null,this$);
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","on-close-remove","lt.objs.settings/on-close-remove",4619688773),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__on_close_remove,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"close","close",1108660586),null], null), null));
lt.objs.settings.__GT_ordered_keystr = (function __GT_ordered_keystr(k){var char$ = ((cljs.core._EQ_.call(null,cljs.core.last.call(null,k),"-"))?"-":cljs.core.last.call(null,clojure.string.split.call(null,k,"-")));return [cljs.core.str(((lt.util.cljs.str_contains_QMARK_.call(null,k,"ctrl"))?"ctrl-":null)),cljs.core.str(((lt.util.cljs.str_contains_QMARK_.call(null,k,"cmd"))?"cmd-":null)),cljs.core.str(((lt.util.cljs.str_contains_QMARK_.call(null,k,"meta"))?"meta-":null)),cljs.core.str(((lt.util.cljs.str_contains_QMARK_.call(null,k,"altgr"))?"altgr-":null)),cljs.core.str(((lt.util.cljs.str_contains_QMARK_.call(null,k,"alt"))?"alt-":null)),cljs.core.str(((lt.util.cljs.str_contains_QMARK_.call(null,k,"shift"))?"shift-":null)),cljs.core.str(char$)].join('');
});
lt.objs.settings.fix_key = (function fix_key(k){var k__$1 = clojure.string.replace.call(null,k,"pmeta",lt.objs.keyboard.meta);var keys = clojure.string.split.call(null,k__$1," ");return cljs.core.reduce.call(null,(function (p1__11004_SHARP_,p2__11005_SHARP_){return [cljs.core.str(p1__11004_SHARP_),cljs.core.str(" "),cljs.core.str(p2__11005_SHARP_)].join('');
}),cljs.core.map.call(null,lt.objs.settings.__GT_ordered_keystr,keys));
});
lt.objs.settings.fix_key_entry = (function fix_key_entry(p__11006){var vec__11008 = p__11006;var k = cljs.core.nth.call(null,vec__11008,0,null);var v = cljs.core.nth.call(null,vec__11008,1,null);return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [lt.objs.settings.fix_key.call(null,k),v], null);
});
lt.objs.settings._PLUS_keys = (function _PLUS_keys(cur,m){return cljs.core.reduce.call(null,(function (res,p__11012){var vec__11013 = p__11012;var k = cljs.core.nth.call(null,vec__11013,0,null);var v = cljs.core.nth.call(null,vec__11013,1,null);return cljs.core.update_in.call(null,res,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [k], null),(function (p1__11009_SHARP_){return cljs.core.into.call(null,(function (){var or__3408__auto__ = p1__11009_SHARP_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.PersistentArrayMap.EMPTY;
}
})(),cljs.core.map.call(null,lt.objs.settings.fix_key_entry,v));
}));
}),cur,m);
});
lt.objs.settings._keys = (function _keys(cur,m){return cljs.core.reduce.call(null,(function (res,p__11017){var vec__11018 = p__11017;var k = cljs.core.nth.call(null,vec__11018,0,null);var v = cljs.core.nth.call(null,vec__11018,1,null);return cljs.core.update_in.call(null,res,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [k], null),(function (p1__11014_SHARP_){return cljs.core.apply.call(null,cljs.core.dissoc,p1__11014_SHARP_,cljs.core.map.call(null,lt.objs.settings.fix_key,((cljs.core.map_QMARK_.call(null,v))?cljs.core.keys.call(null,v):v)));
}));
}),cur,m);
});
lt.objs.settings.key_diff = (function key_diff(p__11019,final$){var map__11021 = p__11019;var map__11021__$1 = ((cljs.core.seq_QMARK_.call(null,map__11021))?cljs.core.apply.call(null,cljs.core.hash_map,map__11021):map__11021);var add = cljs.core.get.call(null,map__11021__$1,new cljs.core.Keyword(null,"+","+",1013904285));var rem = cljs.core.get.call(null,map__11021__$1,new cljs.core.Keyword(null,"-","-",1013904287));return lt.objs.settings._PLUS_keys.call(null,lt.objs.settings._keys.call(null,final$,rem),add);
});
lt.objs.settings.parse_key_file = (function parse_key_file(file,final$){return lt.objs.settings.safe_read.call(null,new cljs.core.Keyword(null,"content","content",1965434859).cljs$core$IFn$_invoke$arity$1(lt.objs.files.open_sync.call(null,file)),file);
});
lt.objs.settings.keymap_diffs_in = (function keymap_diffs_in(path){if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,path)))
{return cljs.core.map.call(null,lt.objs.settings.parse_key_file,cljs.core.filter.call(null,(function (p1__11022_SHARP_){return cljs.core._EQ_.call(null,lt.objs.files.ext.call(null,p1__11022_SHARP_),"keymap");
}),lt.objs.files.full_path_ls.call(null,path)));
} else
{return null;
}
});
lt.objs.settings.load_all_keys = (function load_all_keys(){var final$ = cljs.core.reduce.call(null,(function (fin,cur){return lt.objs.settings.key_diff.call(null,cur,fin);
}),cljs.core.PersistentArrayMap.EMPTY,cljs.core.concat.call(null,lt.object.raise_reduce.call(null,lt.objs.app.app,new cljs.core.Keyword(null,"keymap.diffs.default+","keymap.diffs.default+",711992781),cljs.core.PersistentVector.EMPTY),lt.object.raise_reduce.call(null,lt.objs.app.app,new cljs.core.Keyword(null,"keymap.diffs.plugin+","keymap.diffs.plugin+",4109982809),cljs.core.PersistentVector.EMPTY),lt.object.raise_reduce.call(null,lt.objs.app.app,new cljs.core.Keyword(null,"keymap.diffs.user+","keymap.diffs.user+",1410763393),cljs.core.PersistentVector.EMPTY)));return cljs.core.reset_BANG_.call(null,lt.objs.keyboard.keys,final$);
});
lt.objs.settings.__BEH__default_keymap_diffs = (function __BEH__default_keymap_diffs(this$,diffs){return cljs.core.concat.call(null,diffs,lt.objs.settings.keymap_diffs_in.call(null,lt.objs.files.lt_home.call(null,"/settings/default/")));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","default-keymap-diffs","lt.objs.settings/default-keymap-diffs",3391340802),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__default_keymap_diffs,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"keymap.diffs.default+","keymap.diffs.default+",711992781),null], null), null));
lt.objs.settings.__BEH__user_keymap_diffs = (function __BEH__user_keymap_diffs(this$,diffs){return cljs.core.concat.call(null,diffs,lt.objs.settings.keymap_diffs_in.call(null,lt.objs.files.lt_user_dir.call(null,"/settings/")));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","user-keymap-diffs","lt.objs.settings/user-keymap-diffs",3926753964),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__user_keymap_diffs,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"keymap.diffs.user+","keymap.diffs.user+",1410763393),null], null), null));
lt.objs.settings.__BEH__on_behaviors_editor_save = (function __BEH__on_behaviors_editor_save(editor){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","on-behaviors-editor-save","lt.objs.settings/on-behaviors-editor-save",3927833097),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__on_behaviors_editor_save,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"saved","saved",1123115513),null], null), null));
lt.objs.settings.__BEH__on_keymap_editor_save = (function __BEH__on_keymap_editor_save(editor){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"keymaps.reload","keymaps.reload",666881155));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.settings","on-keymap-editor-save","lt.objs.settings/on-keymap-editor-save",1834857841),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.settings.__BEH__on_keymap_editor_save,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"saved","saved",1123115513),null], null), null));
lt.object.tag_behaviors.call(null,new cljs.core.Keyword(null,"app","app",1014001043),new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.settings","initial-behaviors","lt.objs.settings/initial-behaviors",1554007604),new cljs.core.Keyword("lt.objs.settings","load-behaviors","lt.objs.settings/load-behaviors",1077508690),new cljs.core.Keyword("lt.objs.settings","default-behavior-diffs","lt.objs.settings/default-behavior-diffs",3478385645),new cljs.core.Keyword("lt.objs.settings","user-behavior-diffs","lt.objs.settings/user-behavior-diffs",2390870839),new cljs.core.Keyword("lt.objs.settings","default-keymap-diffs","lt.objs.settings/default-keymap-diffs",3391340802),new cljs.core.Keyword("lt.objs.settings","user-keymap-diffs","lt.objs.settings/user-keymap-diffs",3926753964)], null));
