// Compiled by ClojureScript 0.0-2138
goog.provide('lt.objs.plugins');
goog.require('cljs.core');
goog.require('crate.binding');
goog.require('lt.objs.app');
goog.require('lt.objs.files');
goog.require('lt.objs.settings');
goog.require('clojure.walk');
goog.require('lt.util.dom');
goog.require('lt.objs.context');
goog.require('lt.objs.tabs');
goog.require('lt.objs.popup');
goog.require('lt.objs.popup');
goog.require('cljs.reader');
goog.require('crate.core');
goog.require('lt.objs.context');
goog.require('lt.objs.notifos');
goog.require('lt.objs.notifos');
goog.require('lt.util.dom');
goog.require('lt.objs.editor.pool');
goog.require('clojure.string');
goog.require('lt.util.kahn');
goog.require('clojure.walk');
goog.require('lt.objs.command');
goog.require('lt.objs.files');
goog.require('clojure.set');
goog.require('lt.objs.settings');
goog.require('lt.objs.app');
goog.require('lt.util.kahn');
goog.require('lt.util.load');
goog.require('clojure.string');
goog.require('lt.objs.deploy');
goog.require('crate.binding');
goog.require('lt.object');
goog.require('cljs.reader');
goog.require('lt.object');
goog.require('clojure.set');
goog.require('lt.util.load');
goog.require('lt.objs.console');
goog.require('lt.objs.tabs');
goog.require('lt.objs.console');
goog.require('crate.core');
goog.require('lt.objs.editor.pool');
goog.require('lt.objs.command');
goog.require('fetch.core');
goog.require('lt.objs.deploy');
goog.require('fetch.core');
lt.objs.plugins.plugins_dir = lt.objs.files.lt_home.call(null,"plugins");
lt.objs.plugins.user_plugins_dir = lt.objs.files.lt_user_dir.call(null,"plugins");
lt.objs.plugins.plugins_url = "http://plugins.lighttable.com";
lt.objs.plugins._STAR_plugin_dir_STAR_ = null;
lt.objs.plugins.EOF_read = (function EOF_read(s){if(cljs.core.truth_((function (){var and__3396__auto__ = s;if(cljs.core.truth_(and__3396__auto__))
{return cljs.core.seq.call(null,s);
} else
{return and__3396__auto__;
}
})()))
{return cljs.reader.read_string.call(null,s);
} else
{return null;
}
});
lt.objs.plugins.munge_plugin_name = (function munge_plugin_name(n){if(cljs.core.truth_(n))
{return clojure.string.replace.call(null,clojure.string.replace.call(null,clojure.string.replace.call(null,n," ","_"),"-","_"),".","_");
} else
{return null;
}
});
lt.objs.plugins.adjust_path = (function adjust_path(path){if(lt.objs.files.absolute_QMARK_.call(null,path))
{return path;
} else
{return lt.objs.files.join.call(null,(function (){var or__3408__auto__ = new cljs.core.Keyword("lt.objs.plugins","dir","lt.objs.plugins/dir",3366558592).cljs$core$IFn$_invoke$arity$1(lt.object._STAR_behavior_meta_STAR_);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return lt.objs.files.lt_home.call(null);
}
})(),path);
}
});
lt.objs.plugins.find_plugin = (function find_plugin(plugin_name){var plugin_name__$1 = lt.objs.plugins.munge_plugin_name.call(null,plugin_name);if(cljs.core.truth_(new cljs.core.Keyword("lt.objs.plugins","dir","lt.objs.plugins/dir",3366558592).cljs$core$IFn$_invoke$arity$1(lt.object._STAR_behavior_meta_STAR_)))
{return new cljs.core.Keyword("lt.objs.plugins","dir","lt.objs.plugins/dir",3366558592).cljs$core$IFn$_invoke$arity$1(lt.object._STAR_behavior_meta_STAR_);
} else
{if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,lt.objs.files.join.call(null,lt.objs.plugins.user_plugins_dir,plugin_name__$1))))
{return lt.objs.files.join.call(null,lt.objs.plugins.user_plugins_dir,plugin_name__$1);
} else
{if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,lt.objs.files.join.call(null,lt.objs.plugins.plugins_dir,plugin_name__$1))))
{return lt.objs.files.join.call(null,lt.objs.plugins.plugins_dir,plugin_name__$1);
} else
{if(new cljs.core.Keyword(null,"else","else",1017020587))
{return null;
} else
{return null;
}
}
}
}
});
lt.objs.plugins.local_module = (function local_module(plugin_name,module_name){var temp__4092__auto__ = lt.objs.plugins.find_plugin.call(null,plugin_name);if(cljs.core.truth_(temp__4092__auto__))
{var plugin_path = temp__4092__auto__;return lt.objs.files.join.call(null,plugin_path,"node_modules",module_name);
} else
{return null;
}
});
lt.objs.plugins.by_name = (function by_name(plugin_name){return cljs.core.get.call(null,new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.app.app)),plugin_name);
});
lt.objs.plugins.installed_QMARK_ = (function installed_QMARK_(plugin_name){return cljs.core.boolean$.call(null,lt.objs.plugins.by_name.call(null,plugin_name));
});
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"build","build",1107999200),new cljs.core.Keyword(null,"desc","desc",1016984067),"Editor: build file or project",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){var temp__4092__auto__ = lt.objs.editor.pool.last_active.call(null);if(cljs.core.truth_(temp__4092__auto__))
{var ed = temp__4092__auto__;return lt.object.raise.call(null,ed,new cljs.core.Keyword(null,"build","build",1107999200));
} else
{return null;
}
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"behaviors.force-reload","behaviors.force-reload",1611218586),new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugins: Ignore cache and force reload the current behaviors file",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){var temp__4092__auto__ = lt.objs.editor.pool.last_active.call(null);if(cljs.core.truth_(temp__4092__auto__))
{var ed = temp__4092__auto__;if(cljs.core.truth_(lt.object.has_tag_QMARK_.call(null,ed,new cljs.core.Keyword(null,"editor.behaviors","editor.behaviors",2095045778))))
{cljs.core.swap_BANG_.call(null,lt.objs.plugins.manager,cljs.core.update_in,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","force-reload","lt.objs.plugins/force-reload",4731263182)], null),(function (p1__9928_SHARP_){return cljs.core.conj.call(null,(function (){var or__3408__auto__ = p1__9928_SHARP_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.PersistentHashSet.EMPTY;
}
})(),cljs.core.get_in.call(null,cljs.core.deref.call(null,ed),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"info","info",1017141280),new cljs.core.Keyword(null,"path","path",1017337751)], null)));
}));
return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600));
} else
{return null;
}
} else
{return null;
}
})], null));
lt.objs.plugins.validate = (function validate(plugin){var valid_QMARK_ = cljs.core.every_QMARK_.call(null,plugin,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"name","name",1017277949),new cljs.core.Keyword(null,"author","author",3902543101),new cljs.core.Keyword(null,"behaviors","behaviors",607554515),new cljs.core.Keyword(null,"desc","desc",1016984067)], null));if(!(valid_QMARK_))
{lt.objs.console.error.call(null,[cljs.core.str("Invalid plugin.json file: "),cljs.core.str(new cljs.core.Keyword(null,"dir","dir",1014003711).cljs$core$IFn$_invoke$arity$1(plugin)),cljs.core.str("/plugin.json \nPlugins\n                            must include values for name, version, author, behaviors, and desc.")].join(''));
return null;
} else
{return plugin;
}
});
lt.objs.plugins.plugin_edn = (function plugin_edn(dir){var temp__4092__auto__ = lt.objs.files.open_sync.call(null,lt.objs.files.join.call(null,dir,"plugin.edn"));if(cljs.core.truth_(temp__4092__auto__))
{var content = temp__4092__auto__;return lt.objs.plugins.validate.call(null,cljs.core.assoc.call(null,lt.objs.plugins.EOF_read.call(null,new cljs.core.Keyword(null,"content","content",1965434859).cljs$core$IFn$_invoke$arity$1(content)),new cljs.core.Keyword(null,"dir","dir",1014003711),dir));
} else
{return null;
}
});
lt.objs.plugins.plugin_json = (function plugin_json(dir){var temp__4092__auto__ = lt.objs.files.open_sync.call(null,lt.objs.files.join.call(null,dir,"plugin.json"));if(cljs.core.truth_(temp__4092__auto__))
{var content = temp__4092__auto__;return lt.objs.plugins.validate.call(null,cljs.core.assoc.call(null,cljs.core.js__GT_clj.call(null,JSON.parse(new cljs.core.Keyword(null,"content","content",1965434859).cljs$core$IFn$_invoke$arity$1(content)),new cljs.core.Keyword(null,"keywordize-keys","keywordize-keys",4191781672),true),new cljs.core.Keyword(null,"dir","dir",1014003711),dir));
} else
{return null;
}
});
lt.objs.plugins.plugin_info = (function plugin_info(dir){var or__3408__auto__ = lt.objs.plugins.plugin_json.call(null,dir);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return lt.objs.plugins.plugin_edn.call(null,dir);
}
});
lt.objs.plugins.missing_deps = (function missing_deps(all){var deps = cljs.core.mapcat.call(null,cljs.core.comp.call(null,cljs.core.seq,new cljs.core.Keyword(null,"dependencies","dependencies",1517678747)),cljs.core.vals.call(null,all));return cljs.core.seq.call(null,cljs.core.vals.call(null,cljs.core.persistent_BANG_.call(null,cljs.core.reduce.call(null,(function (final$,p__9931){var vec__9932 = p__9931;var name = cljs.core.nth.call(null,vec__9932,0,null);var version = cljs.core.nth.call(null,vec__9932,1,null);var name__$1 = cljs.core.name.call(null,name);var temp__4090__auto__ = (function (){var or__3408__auto__ = cljs.core.get.call(null,all,name__$1);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.get.call(null,final$,name__$1);
}
})();if(cljs.core.truth_(temp__4090__auto__))
{var cur = temp__4090__auto__;if(lt.objs.deploy.is_newer_QMARK_.call(null,new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(cur),version))
{return cljs.core.assoc_BANG_.call(null,final$,name__$1,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"name","name",1017277949),name__$1,new cljs.core.Keyword(null,"version","version",1365512266),version], null));
} else
{return final$;
}
} else
{return cljs.core.assoc_BANG_.call(null,final$,name__$1,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"name","name",1017277949),name__$1,new cljs.core.Keyword(null,"version","version",1365512266),version], null));
}
}),cljs.core.transient$.call(null,cljs.core.PersistentArrayMap.EMPTY),deps))));
});
lt.objs.plugins.install_missing = (function install_missing(missing){var counter = cljs.core.atom.call(null,cljs.core.count.call(null,missing));var count_down = ((function (counter){
return (function (){cljs.core.swap_BANG_.call(null,counter,cljs.core.dec);
if((cljs.core.deref.call(null,counter) <= 0))
{lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600));
lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"refresh!","refresh!",4597922840));
return lt.objs.notifos.set_msg_BANG_.call(null,"All missing dependencies installed.");
} else
{return null;
}
});})(counter))
;var seq__9937 = cljs.core.seq.call(null,missing);var chunk__9938 = null;var count__9939 = 0;var i__9940 = 0;while(true){
if((i__9940 < count__9939))
{var dep = cljs.core._nth.call(null,chunk__9938,i__9940);lt.objs.plugins.discover_deps.call(null,dep,count_down);
{
var G__9941 = seq__9937;
var G__9942 = chunk__9938;
var G__9943 = count__9939;
var G__9944 = (i__9940 + 1);
seq__9937 = G__9941;
chunk__9938 = G__9942;
count__9939 = G__9943;
i__9940 = G__9944;
continue;
}
} else
{var temp__4092__auto__ = cljs.core.seq.call(null,seq__9937);if(temp__4092__auto__)
{var seq__9937__$1 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,seq__9937__$1))
{var c__4150__auto__ = cljs.core.chunk_first.call(null,seq__9937__$1);{
var G__9945 = cljs.core.chunk_rest.call(null,seq__9937__$1);
var G__9946 = c__4150__auto__;
var G__9947 = cljs.core.count.call(null,c__4150__auto__);
var G__9948 = 0;
seq__9937 = G__9945;
chunk__9938 = G__9946;
count__9939 = G__9947;
i__9940 = G__9948;
continue;
}
} else
{var dep = cljs.core.first.call(null,seq__9937__$1);lt.objs.plugins.discover_deps.call(null,dep,count_down);
{
var G__9949 = cljs.core.next.call(null,seq__9937__$1);
var G__9950 = null;
var G__9951 = 0;
var G__9952 = 0;
seq__9937 = G__9949;
chunk__9938 = G__9950;
count__9939 = G__9951;
i__9940 = G__9952;
continue;
}
}
} else
{return null;
}
}
break;
}
});
lt.objs.plugins.available_plugins = (function available_plugins(){var ds = cljs.core.concat.call(null,lt.objs.files.dirs.call(null,lt.objs.plugins.user_plugins_dir),lt.objs.files.dirs.call(null,lt.objs.plugins.plugins_dir));var plugins = cljs.core.filterv.call(null,cljs.core.identity,cljs.core.map.call(null,lt.objs.plugins.plugin_info,ds));var final$ = cljs.core.persistent_BANG_.call(null,cljs.core.reduce.call(null,((function (ds,plugins){
return (function (final$,p){var temp__4090__auto__ = cljs.core.get.call(null,final$,new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(p));if(cljs.core.truth_(temp__4090__auto__))
{var cur = temp__4090__auto__;if(lt.objs.deploy.is_newer_QMARK_.call(null,new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(cur),new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(p)))
{return cljs.core.assoc_BANG_.call(null,final$,new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(p),p);
} else
{return final$;
}
} else
{return cljs.core.assoc_BANG_.call(null,final$,new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(p),p);
}
});})(ds,plugins))
,cljs.core.transient$.call(null,cljs.core.PersistentArrayMap.EMPTY),plugins));var missing_QMARK_ = lt.objs.plugins.missing_deps.call(null,final$);if(missing_QMARK_)
{lt.objs.popup.popup_BANG_.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"header","header",4087600639),"Some plugin dependencies are missing.",new cljs.core.Keyword(null,"body","body",1016933652),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span","span",1017440956),"We found that the following plugin dependencies are missing: "], null),(function (){var iter__4119__auto__ = (function iter__9961(s__9962){return (new cljs.core.LazySeq(null,(function (){var s__9962__$1 = s__9962;while(true){
var temp__4092__auto__ = cljs.core.seq.call(null,s__9962__$1);if(temp__4092__auto__)
{var s__9962__$2 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,s__9962__$2))
{var c__4117__auto__ = cljs.core.chunk_first.call(null,s__9962__$2);var size__4118__auto__ = cljs.core.count.call(null,c__4117__auto__);var b__9964 = cljs.core.chunk_buffer.call(null,size__4118__auto__);if((function (){var i__9963 = 0;while(true){
if((i__9963 < size__4118__auto__))
{var map__9967 = cljs.core._nth.call(null,c__4117__auto__,i__9963);var map__9967__$1 = ((cljs.core.seq_QMARK_.call(null,map__9967))?cljs.core.apply.call(null,cljs.core.hash_map,map__9967):map__9967);var version = cljs.core.get.call(null,map__9967__$1,new cljs.core.Keyword(null,"version","version",1365512266));var name = cljs.core.get.call(null,map__9967__$1,new cljs.core.Keyword(null,"name","name",1017277949));cljs.core.chunk_append.call(null,b__9964,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),name," ",version," "], null));
{
var G__9969 = (i__9963 + 1);
i__9963 = G__9969;
continue;
}
} else
{return true;
}
break;
}
})())
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__9964),iter__9961.call(null,cljs.core.chunk_rest.call(null,s__9962__$2)));
} else
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__9964),null);
}
} else
{var map__9968 = cljs.core.first.call(null,s__9962__$2);var map__9968__$1 = ((cljs.core.seq_QMARK_.call(null,map__9968))?cljs.core.apply.call(null,cljs.core.hash_map,map__9968):map__9968);var version = cljs.core.get.call(null,map__9968__$1,new cljs.core.Keyword(null,"version","version",1365512266));var name = cljs.core.get.call(null,map__9968__$1,new cljs.core.Keyword(null,"name","name",1017277949));return cljs.core.cons.call(null,new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),name," ",version," "], null),iter__9961.call(null,cljs.core.rest.call(null,s__9962__$2)));
}
} else
{return null;
}
break;
}
}),null,null));
});return iter__4119__auto__.call(null,missing_QMARK_);
})(),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span","span",1017440956),"Would you like us to install them?"], null)], null),new cljs.core.Keyword(null,"buttons","buttons",1255256819),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1116631654),"Cancel"], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"label","label",1116631654),"Install all",new cljs.core.Keyword(null,"action","action",3885920680),(function (){return lt.objs.plugins.install_missing.call(null,missing_QMARK_);
})], null)], null)], null));
} else
{}
return final$;
});
lt.objs.plugins.outdated_QMARK_ = (function outdated_QMARK_(plugin){var cached = cljs.core.get.call(null,new cljs.core.Keyword(null,"version-cache","version-cache",684446143).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.plugins.manager)),new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin));if(cljs.core.truth_(cached))
{return lt.objs.deploy.is_newer_QMARK_.call(null,new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(plugin),cached);
} else
{return null;
}
});
lt.objs.plugins.plugin_behaviors = (function plugin_behaviors(plug){var map__9971 = plug;var map__9971__$1 = ((cljs.core.seq_QMARK_.call(null,map__9971))?cljs.core.apply.call(null,cljs.core.hash_map,map__9971):map__9971);var dir = cljs.core.get.call(null,map__9971__$1,new cljs.core.Keyword(null,"dir","dir",1014003711));var behaviors = cljs.core.get.call(null,map__9971__$1,new cljs.core.Keyword(null,"behaviors","behaviors",607554515));var file = lt.objs.files.join.call(null,dir,behaviors);var file__$1 = lt.objs.files.real_path.call(null,file);var behs = lt.objs.settings.safe_read.call(null,new cljs.core.Keyword(null,"content","content",1965434859).cljs$core$IFn$_invoke$arity$1(lt.objs.files.open_sync.call(null,file__$1)),file__$1);var force_QMARK_ = cljs.core.get.call(null,new cljs.core.Keyword("lt.objs.plugins","force-reload","lt.objs.plugins/force-reload",4731263182).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.plugins.manager)),file__$1);if(cljs.core.truth_(force_QMARK_))
{cljs.core.swap_BANG_.call(null,lt.objs.plugins.manager,cljs.core.update_in,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","force-reload","lt.objs.plugins/force-reload",4731263182)], null),cljs.core.disj,file__$1);
} else
{}
if(cljs.core.truth_(behs))
{clojure.walk.prewalk.call(null,(function (x){if(cljs.core.list_QMARK_.call(null,x))
{cljs.core.alter_meta_BANG_.call(null,x,cljs.core.assoc,new cljs.core.Keyword("lt.objs.plugins","dir","lt.objs.plugins/dir",3366558592),dir,new cljs.core.Keyword("lt.objs.plugins","force-reload","lt.objs.plugins/force-reload",4731263182),force_QMARK_);
} else
{}
return x;
}),behs);
return behs;
} else
{return null;
}
});
lt.objs.plugins.plugin_dependency_graph = (function plugin_dependency_graph(plugins){return cljs.core.into.call(null,cljs.core.PersistentArrayMap.EMPTY,(function (){var iter__4119__auto__ = (function iter__9980(s__9981){return (new cljs.core.LazySeq(null,(function (){var s__9981__$1 = s__9981;while(true){
var temp__4092__auto__ = cljs.core.seq.call(null,s__9981__$1);if(temp__4092__auto__)
{var s__9981__$2 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,s__9981__$2))
{var c__4117__auto__ = cljs.core.chunk_first.call(null,s__9981__$2);var size__4118__auto__ = cljs.core.count.call(null,c__4117__auto__);var b__9983 = cljs.core.chunk_buffer.call(null,size__4118__auto__);if((function (){var i__9982 = 0;while(true){
if((i__9982 < size__4118__auto__))
{var vec__9986 = cljs.core._nth.call(null,c__4117__auto__,i__9982);var nme = cljs.core.nth.call(null,vec__9986,0,null);var v = cljs.core.nth.call(null,vec__9986,1,null);cljs.core.chunk_append.call(null,b__9983,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [nme,cljs.core.set.call(null,cljs.core.map.call(null,cljs.core.name,cljs.core.keys.call(null,new cljs.core.Keyword(null,"dependencies","dependencies",1517678747).cljs$core$IFn$_invoke$arity$1(v))))], null));
{
var G__9988 = (i__9982 + 1);
i__9982 = G__9988;
continue;
}
} else
{return true;
}
break;
}
})())
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__9983),iter__9980.call(null,cljs.core.chunk_rest.call(null,s__9981__$2)));
} else
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__9983),null);
}
} else
{var vec__9987 = cljs.core.first.call(null,s__9981__$2);var nme = cljs.core.nth.call(null,vec__9987,0,null);var v = cljs.core.nth.call(null,vec__9987,1,null);return cljs.core.cons.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [nme,cljs.core.set.call(null,cljs.core.map.call(null,cljs.core.name,cljs.core.keys.call(null,new cljs.core.Keyword(null,"dependencies","dependencies",1517678747).cljs$core$IFn$_invoke$arity$1(v))))], null),iter__9980.call(null,cljs.core.rest.call(null,s__9981__$2)));
}
} else
{return null;
}
break;
}
}),null,null));
});return iter__4119__auto__.call(null,plugins);
})());
});
lt.objs.plugins.find_cycles = (function find_cycles(cur,p__9989){var map__9995 = p__9989;var map__9995__$1 = ((cljs.core.seq_QMARK_.call(null,map__9995))?cljs.core.apply.call(null,cljs.core.hash_map,map__9995):map__9995);var state = map__9995__$1;var graph = cljs.core.get.call(null,map__9995__$1,new cljs.core.Keyword(null,"graph","graph",1112519872));var stack = cljs.core.get.call(null,map__9995__$1,new cljs.core.Keyword(null,"stack","stack",1123661306));var root = cljs.core.get.call(null,map__9995__$1,new cljs.core.Keyword(null,"root","root",1017410644));var seen = cljs.core.get.call(null,map__9995__$1,new cljs.core.Keyword(null,"seen","seen",1017430509));return cljs.core.first.call(null,cljs.core.filter.call(null,cljs.core.identity,(function (){var iter__4119__auto__ = (function iter__9996(s__9997){return (new cljs.core.LazySeq(null,(function (){var s__9997__$1 = s__9997;while(true){
var temp__4092__auto__ = cljs.core.seq.call(null,s__9997__$1);if(temp__4092__auto__)
{var s__9997__$2 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,s__9997__$2))
{var c__4117__auto__ = cljs.core.chunk_first.call(null,s__9997__$2);var size__4118__auto__ = cljs.core.count.call(null,c__4117__auto__);var b__9999 = cljs.core.chunk_buffer.call(null,size__4118__auto__);if((function (){var i__9998 = 0;while(true){
if((i__9998 < size__4118__auto__))
{var c = cljs.core._nth.call(null,c__4117__auto__,i__9998);cljs.core.chunk_append.call(null,b__9999,((cljs.core._EQ_.call(null,c,root))?cljs.core.conj.call(null,stack,c):find_cycles.call(null,cljs.core.get.call(null,graph,c),cljs.core.update_in.call(null,cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"stack","stack",1123661306)], null),cljs.core.conj,c),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"seen","seen",1017430509)], null),cljs.core.conj,c))));
{
var G__10000 = (i__9998 + 1);
i__9998 = G__10000;
continue;
}
} else
{return true;
}
break;
}
})())
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__9999),iter__9996.call(null,cljs.core.chunk_rest.call(null,s__9997__$2)));
} else
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__9999),null);
}
} else
{var c = cljs.core.first.call(null,s__9997__$2);return cljs.core.cons.call(null,((cljs.core._EQ_.call(null,c,root))?cljs.core.conj.call(null,stack,c):find_cycles.call(null,cljs.core.get.call(null,graph,c),cljs.core.update_in.call(null,cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"stack","stack",1123661306)], null),cljs.core.conj,c),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"seen","seen",1017430509)], null),cljs.core.conj,c))),iter__9996.call(null,cljs.core.rest.call(null,s__9997__$2)));
}
} else
{return null;
}
break;
}
}),null,null));
});return iter__4119__auto__.call(null,cljs.core.remove.call(null,seen,cur));
})()));
});
lt.objs.plugins.__GT_cycles = (function __GT_cycles(graph){return cljs.core.filterv.call(null,cljs.core.identity,(function (){var iter__4119__auto__ = (function iter__10009(s__10010){return (new cljs.core.LazySeq(null,(function (){var s__10010__$1 = s__10010;while(true){
var temp__4092__auto__ = cljs.core.seq.call(null,s__10010__$1);if(temp__4092__auto__)
{var s__10010__$2 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,s__10010__$2))
{var c__4117__auto__ = cljs.core.chunk_first.call(null,s__10010__$2);var size__4118__auto__ = cljs.core.count.call(null,c__4117__auto__);var b__10012 = cljs.core.chunk_buffer.call(null,size__4118__auto__);if((function (){var i__10011 = 0;while(true){
if((i__10011 < size__4118__auto__))
{var vec__10015 = cljs.core._nth.call(null,c__4117__auto__,i__10011);var root = cljs.core.nth.call(null,vec__10015,0,null);var deps = cljs.core.nth.call(null,vec__10015,1,null);var stack = lt.objs.plugins.find_cycles.call(null,deps,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"seen","seen",1017430509),cljs.core.PersistentHashSet.EMPTY,new cljs.core.Keyword(null,"stack","stack",1123661306),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [root], null),new cljs.core.Keyword(null,"graph","graph",1112519872),graph,new cljs.core.Keyword(null,"root","root",1017410644),root], null));cljs.core.chunk_append.call(null,b__10012,stack);
{
var G__10017 = (i__10011 + 1);
i__10011 = G__10017;
continue;
}
} else
{return true;
}
break;
}
})())
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__10012),iter__10009.call(null,cljs.core.chunk_rest.call(null,s__10010__$2)));
} else
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__10012),null);
}
} else
{var vec__10016 = cljs.core.first.call(null,s__10010__$2);var root = cljs.core.nth.call(null,vec__10016,0,null);var deps = cljs.core.nth.call(null,vec__10016,1,null);var stack = lt.objs.plugins.find_cycles.call(null,deps,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"seen","seen",1017430509),cljs.core.PersistentHashSet.EMPTY,new cljs.core.Keyword(null,"stack","stack",1123661306),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [root], null),new cljs.core.Keyword(null,"graph","graph",1112519872),graph,new cljs.core.Keyword(null,"root","root",1017410644),root], null));return cljs.core.cons.call(null,stack,iter__10009.call(null,cljs.core.rest.call(null,s__10010__$2)));
}
} else
{return null;
}
break;
}
}),null,null));
});return iter__4119__auto__.call(null,graph);
})());
});
lt.objs.plugins.cycle_desc = (function cycle_desc(cycles){var iter__4119__auto__ = (function iter__10022(s__10023){return (new cljs.core.LazySeq(null,(function (){var s__10023__$1 = s__10023;while(true){
var temp__4092__auto__ = cljs.core.seq.call(null,s__10023__$1);if(temp__4092__auto__)
{var s__10023__$2 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,s__10023__$2))
{var c__4117__auto__ = cljs.core.chunk_first.call(null,s__10023__$2);var size__4118__auto__ = cljs.core.count.call(null,c__4117__auto__);var b__10025 = cljs.core.chunk_buffer.call(null,size__4118__auto__);if((function (){var i__10024 = 0;while(true){
if((i__10024 < size__4118__auto__))
{var cycle = cljs.core._nth.call(null,c__4117__auto__,i__10024);cljs.core.chunk_append.call(null,b__10025,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),cljs.core.reduce.call(null,cljs.core.str,cljs.core.interpose.call(null," => ",cycle))], null));
{
var G__10026 = (i__10024 + 1);
i__10024 = G__10026;
continue;
}
} else
{return true;
}
break;
}
})())
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__10025),iter__10022.call(null,cljs.core.chunk_rest.call(null,s__10023__$2)));
} else
{return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__10025),null);
}
} else
{var cycle = cljs.core.first.call(null,s__10023__$2);return cljs.core.cons.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),cljs.core.reduce.call(null,cljs.core.str,cljs.core.interpose.call(null," => ",cycle))], null),iter__10022.call(null,cljs.core.rest.call(null,s__10023__$2)));
}
} else
{return null;
}
break;
}
}),null,null));
});return iter__4119__auto__.call(null,cycles);
});
lt.objs.plugins.install_failed = (function install_failed(name){if(cljs.core.truth_((function (){var and__3396__auto__ = lt.objs.plugins.by_name.call(null,name);if(cljs.core.truth_(and__3396__auto__))
{return cljs.core.not.call(null,new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(lt.objs.plugins.by_name.call(null,name)));
} else
{return and__3396__auto__;
}
})()))
{lt.object.update_BANG_.call(null,lt.objs.app.app,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683)], null),cljs.core.dissoc,name);
} else
{}
return lt.objs.notifos.done_working.call(null,[cljs.core.str("Plugin install failed for: "),cljs.core.str(name)].join(''));
});
lt.objs.plugins.fetch_and_install = (function fetch_and_install(url,name,cb){var munged_name = lt.objs.plugins.munge_plugin_name.call(null,name);var tmp_gz = [cljs.core.str(lt.objs.plugins.user_plugins_dir),cljs.core.str("/"),cljs.core.str(munged_name),cljs.core.str("-tmp.tar.gz")].join('');var tmp_dir = [cljs.core.str(lt.objs.plugins.user_plugins_dir),cljs.core.str("/"),cljs.core.str(munged_name),cljs.core.str("-tmp")].join('');lt.objs.notifos.working.call(null,[cljs.core.str("Downloading plugin: "),cljs.core.str(name)].join(''));
return lt.objs.deploy.download_file.call(null,url,tmp_gz,(function (){lt.objs.notifos.done_working.call(null);
lt.objs.notifos.working.call(null,"Extracting plugin...");
return lt.objs.deploy.untar.call(null,tmp_gz,tmp_dir,(function (){var munged_dir = cljs.core.first.call(null,lt.objs.files.full_path_ls.call(null,tmp_dir));var final_path = [cljs.core.str(lt.objs.plugins.user_plugins_dir),cljs.core.str("/"),cljs.core.str(munged_name),cljs.core.str("/")].join('');if(cljs.core.truth_(munged_dir))
{if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,final_path)))
{lt.objs.files.delete_BANG_.call(null,final_path);
} else
{}
lt.objs.files.move_BANG_.call(null,munged_dir,final_path);
} else
{}
lt.objs.files.delete_BANG_.call(null,tmp_dir);
lt.objs.files.delete_BANG_.call(null,tmp_gz);
if(cljs.core.truth_(munged_dir))
{lt.objs.notifos.done_working.call(null,[cljs.core.str("Plugin fetched: "),cljs.core.str(name)].join(''));
lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"plugin.fetched","plugin.fetched",1905646736));
if(cljs.core.truth_(cb))
{return cb.call(null);
} else
{return null;
}
} else
{return lt.objs.plugins.install_failed.call(null,name);
}
}));
}));
});
lt.objs.plugins.install_version = (function install_version(plugin,cb){var name = new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"info","info",1017141280).cljs$core$IFn$_invoke$arity$1(plugin));var ver = new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(plugin);var installed_QMARK_ = cljs.core.get.call(null,new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.app.app)),name);if(cljs.core.truth_((function (){var or__3408__auto__ = cljs.core.not.call(null,installed_QMARK_);if(or__3408__auto__)
{return or__3408__auto__;
} else
{var and__3396__auto__ = new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(installed_QMARK_);if(cljs.core.truth_(and__3396__auto__))
{return lt.objs.deploy.is_newer_QMARK_.call(null,new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(installed_QMARK_),ver);
} else
{return and__3396__auto__;
}
}
})()))
{lt.object.update_BANG_.call(null,lt.objs.app.app,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683)], null),cljs.core.assoc,name,cljs.core.PersistentArrayMap.EMPTY);
return lt.objs.plugins.fetch_and_install.call(null,new cljs.core.Keyword(null,"tar","tar",1014018839).cljs$core$IFn$_invoke$arity$1(plugin),name,(function (){if(cljs.core.truth_(cb))
{return cb.call(null,true);
} else
{return null;
}
}));
} else
{lt.objs.notifos.set_msg_BANG_.call(null,[cljs.core.str(name),cljs.core.str(" is already installed")].join(''));
if(cljs.core.truth_(cb))
{return cb.call(null,false);
} else
{return null;
}
}
});
lt.objs.plugins.transitive_install = (function transitive_install(plugin,deps,cb){var cur = (function (){var or__3408__auto__ = new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"info","info",1017141280).cljs$core$IFn$_invoke$arity$1(plugin));
}
})();var others = cljs.core.dissoc.call(null,deps,cur);var counter = cljs.core.atom.call(null,cljs.core.count.call(null,others));var count_down = ((function (cur,others,counter){
return (function (){cljs.core.swap_BANG_.call(null,counter,cljs.core.dec);
if((cljs.core.deref.call(null,counter) <= 0))
{return lt.objs.plugins.install_version.call(null,deps.call(null,cur),((function (cur,others,counter){
return (function (installed_QMARK_){if(cljs.core.truth_(cb))
{return cb.call(null,installed_QMARK_);
} else
{return null;
}
});})(cur,others,counter))
);
} else
{return null;
}
});})(cur,others,counter))
;if(cljs.core.seq.call(null,others))
{var seq__10033 = cljs.core.seq.call(null,others);var chunk__10034 = null;var count__10035 = 0;var i__10036 = 0;while(true){
if((i__10036 < count__10035))
{var vec__10037 = cljs.core._nth.call(null,chunk__10034,i__10036);var _ = cljs.core.nth.call(null,vec__10037,0,null);var dep = cljs.core.nth.call(null,vec__10037,1,null);lt.objs.plugins.install_version.call(null,dep,count_down);
{
var G__10039 = seq__10033;
var G__10040 = chunk__10034;
var G__10041 = count__10035;
var G__10042 = (i__10036 + 1);
seq__10033 = G__10039;
chunk__10034 = G__10040;
count__10035 = G__10041;
i__10036 = G__10042;
continue;
}
} else
{var temp__4092__auto__ = cljs.core.seq.call(null,seq__10033);if(temp__4092__auto__)
{var seq__10033__$1 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10033__$1))
{var c__4150__auto__ = cljs.core.chunk_first.call(null,seq__10033__$1);{
var G__10043 = cljs.core.chunk_rest.call(null,seq__10033__$1);
var G__10044 = c__4150__auto__;
var G__10045 = cljs.core.count.call(null,c__4150__auto__);
var G__10046 = 0;
seq__10033 = G__10043;
chunk__10034 = G__10044;
count__10035 = G__10045;
i__10036 = G__10046;
continue;
}
} else
{var vec__10038 = cljs.core.first.call(null,seq__10033__$1);var _ = cljs.core.nth.call(null,vec__10038,0,null);var dep = cljs.core.nth.call(null,vec__10038,1,null);lt.objs.plugins.install_version.call(null,dep,count_down);
{
var G__10047 = cljs.core.next.call(null,seq__10033__$1);
var G__10048 = null;
var G__10049 = 0;
var G__10050 = 0;
seq__10033 = G__10047;
chunk__10034 = G__10048;
count__10035 = G__10049;
i__10036 = G__10050;
continue;
}
}
} else
{return null;
}
}
break;
}
} else
{return count_down.call(null);
}
});
lt.objs.plugins.discover_deps = (function discover_deps(plugin,cb){return fetch.core.xhr.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"post","post",1017351186),[cljs.core.str(lt.objs.plugins.plugins_url),cljs.core.str("/install")].join('')], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"name","name",1017277949),(function (){var or__3408__auto__ = new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"info","info",1017141280).cljs$core$IFn$_invoke$arity$1(plugin));
}
})(),new cljs.core.Keyword(null,"version","version",1365512266),(function (){var or__3408__auto__ = new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(plugin);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"info","info",1017141280).cljs$core$IFn$_invoke$arity$1(plugin));
}
})()], null),(function (data){if(cljs.core.not.call(null,(function (){var and__3396__auto__ = data;if(cljs.core.truth_(and__3396__auto__))
{return cljs.core.seq.call(null,data);
} else
{return and__3396__auto__;
}
})()))
{return lt.objs.plugins.install_failed.call(null,(function (){var or__3408__auto__ = new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin);if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"info","info",1017141280).cljs$core$IFn$_invoke$arity$1(plugin));
}
})());
} else
{return lt.objs.plugins.transitive_install.call(null,plugin,lt.objs.plugins.EOF_read.call(null,data),cb);
}
}));
});
lt.objs.plugins.uninstall = (function uninstall(plugin){lt.objs.files.delete_BANG_.call(null,new cljs.core.Keyword(null,"dir","dir",1014003711).cljs$core$IFn$_invoke$arity$1(plugin));
return lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"refresh!","refresh!",4597922840));
});
lt.objs.plugins.url_input = (function url_input(){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"input","input",1114262332),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"type","type",1017479852),"text",new cljs.core.Keyword(null,"placeholder","placeholder",1612151013),"Github URL"], null)], null));var seq__10057_10063 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"focus","focus",1111509066),(function (){return lt.objs.context.in_BANG_.call(null,new cljs.core.Keyword(null,"popup.input","popup.input",4788025210));
}),new cljs.core.Keyword(null,"blur","blur",1016931289),(function (){return lt.objs.context.out_BANG_.call(null,new cljs.core.Keyword(null,"popup.input","popup.input",4788025210));
})], null)));var chunk__10058_10064 = null;var count__10059_10065 = 0;var i__10060_10066 = 0;while(true){
if((i__10060_10066 < count__10059_10065))
{var vec__10061_10067 = cljs.core._nth.call(null,chunk__10058_10064,i__10060_10066);var ev__4336__auto___10068 = cljs.core.nth.call(null,vec__10061_10067,0,null);var func__4337__auto___10069 = cljs.core.nth.call(null,vec__10061_10067,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10068,func__4337__auto___10069);
{
var G__10070 = seq__10057_10063;
var G__10071 = chunk__10058_10064;
var G__10072 = count__10059_10065;
var G__10073 = (i__10060_10066 + 1);
seq__10057_10063 = G__10070;
chunk__10058_10064 = G__10071;
count__10059_10065 = G__10072;
i__10060_10066 = G__10073;
continue;
}
} else
{var temp__4092__auto___10074 = cljs.core.seq.call(null,seq__10057_10063);if(temp__4092__auto___10074)
{var seq__10057_10075__$1 = temp__4092__auto___10074;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10057_10075__$1))
{var c__4150__auto___10076 = cljs.core.chunk_first.call(null,seq__10057_10075__$1);{
var G__10077 = cljs.core.chunk_rest.call(null,seq__10057_10075__$1);
var G__10078 = c__4150__auto___10076;
var G__10079 = cljs.core.count.call(null,c__4150__auto___10076);
var G__10080 = 0;
seq__10057_10063 = G__10077;
chunk__10058_10064 = G__10078;
count__10059_10065 = G__10079;
i__10060_10066 = G__10080;
continue;
}
} else
{var vec__10062_10081 = cljs.core.first.call(null,seq__10057_10075__$1);var ev__4336__auto___10082 = cljs.core.nth.call(null,vec__10062_10081,0,null);var func__4337__auto___10083 = cljs.core.nth.call(null,vec__10062_10081,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10082,func__4337__auto___10083);
{
var G__10084 = cljs.core.next.call(null,seq__10057_10075__$1);
var G__10085 = null;
var G__10086 = 0;
var G__10087 = 0;
seq__10057_10063 = G__10084;
chunk__10058_10064 = G__10085;
count__10059_10065 = G__10086;
i__10060_10066 = G__10087;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.submit_url = (function submit_url(){var input = lt.objs.plugins.url_input.call(null);var p = lt.objs.popup.popup_BANG_.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"header","header",4087600639),"Submit a plugin to the central repository",new cljs.core.Keyword(null,"body","body",1016933652),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"p","p",1013904354),"You can submit a github url to add a plugin to the central repository.\n                                 All plugin repos must have at least one tag in version format, e.g. 0.1.2 and must have a plugin.json\n                                 with name, version, desc, and behaviors keys. To refresh the available versions, just resubmit the plugin."], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"label","label",1116631654),"Github URL for plugin: "], null),input], null),new cljs.core.Keyword(null,"buttons","buttons",1255256819),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1116631654),"cancel"], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"label","label",1116631654),"submit",new cljs.core.Keyword(null,"action","action",3885920680),((function (input){
return (function (){return lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"submit-plugin!","submit-plugin!",2477848075),lt.util.dom.val.call(null,input));
});})(input))
], null)], null)], null));lt.util.dom.focus.call(null,input);
return input.setSelectionRange(1000,1000);
});
lt.objs.plugins.tab = (function tab(this$,tab_name,label){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button","button",3931183780),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",1108647146),crate.binding.bound.call(null,this$,(function (p1__10088_SHARP_){if(cljs.core._EQ_.call(null,tab_name,new cljs.core.Keyword(null,"tab","tab",1014018823).cljs$core$IFn$_invoke$arity$1(p1__10088_SHARP_)))
{return "active";
} else
{return null;
}
}))], null),label], null));var seq__10095_10101 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (){return lt.object.merge_BANG_.call(null,this$,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"tab","tab",1014018823),tab_name], null));
})], null)));var chunk__10096_10102 = null;var count__10097_10103 = 0;var i__10098_10104 = 0;while(true){
if((i__10098_10104 < count__10097_10103))
{var vec__10099_10105 = cljs.core._nth.call(null,chunk__10096_10102,i__10098_10104);var ev__4336__auto___10106 = cljs.core.nth.call(null,vec__10099_10105,0,null);var func__4337__auto___10107 = cljs.core.nth.call(null,vec__10099_10105,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10106,func__4337__auto___10107);
{
var G__10108 = seq__10095_10101;
var G__10109 = chunk__10096_10102;
var G__10110 = count__10097_10103;
var G__10111 = (i__10098_10104 + 1);
seq__10095_10101 = G__10108;
chunk__10096_10102 = G__10109;
count__10097_10103 = G__10110;
i__10098_10104 = G__10111;
continue;
}
} else
{var temp__4092__auto___10112 = cljs.core.seq.call(null,seq__10095_10101);if(temp__4092__auto___10112)
{var seq__10095_10113__$1 = temp__4092__auto___10112;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10095_10113__$1))
{var c__4150__auto___10114 = cljs.core.chunk_first.call(null,seq__10095_10113__$1);{
var G__10115 = cljs.core.chunk_rest.call(null,seq__10095_10113__$1);
var G__10116 = c__4150__auto___10114;
var G__10117 = cljs.core.count.call(null,c__4150__auto___10114);
var G__10118 = 0;
seq__10095_10101 = G__10115;
chunk__10096_10102 = G__10116;
count__10097_10103 = G__10117;
i__10098_10104 = G__10118;
continue;
}
} else
{var vec__10100_10119 = cljs.core.first.call(null,seq__10095_10113__$1);var ev__4336__auto___10120 = cljs.core.nth.call(null,vec__10100_10119,0,null);var func__4337__auto___10121 = cljs.core.nth.call(null,vec__10100_10119,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10120,func__4337__auto___10121);
{
var G__10122 = cljs.core.next.call(null,seq__10095_10113__$1);
var G__10123 = null;
var G__10124 = 0;
var G__10125 = 0;
seq__10095_10101 = G__10122;
chunk__10096_10102 = G__10123;
count__10097_10103 = G__10124;
i__10098_10104 = G__10125;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.search_input = (function search_input(this$){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"input","input",1114262332),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"placeholder","placeholder",1612151013),"Search available plugins"], null)], null));var seq__10132_10138 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"focus","focus",1111509066),(function (){return lt.objs.context.in_BANG_.call(null,new cljs.core.Keyword(null,"plugin-manager.search","plugin-manager.search",4116247637),this$);
}),new cljs.core.Keyword(null,"blur","blur",1016931289),(function (){return lt.objs.context.out_BANG_.call(null,new cljs.core.Keyword(null,"plugin-manager.search","plugin-manager.search",4116247637));
})], null)));var chunk__10133_10139 = null;var count__10134_10140 = 0;var i__10135_10141 = 0;while(true){
if((i__10135_10141 < count__10134_10140))
{var vec__10136_10142 = cljs.core._nth.call(null,chunk__10133_10139,i__10135_10141);var ev__4336__auto___10143 = cljs.core.nth.call(null,vec__10136_10142,0,null);var func__4337__auto___10144 = cljs.core.nth.call(null,vec__10136_10142,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10143,func__4337__auto___10144);
{
var G__10145 = seq__10132_10138;
var G__10146 = chunk__10133_10139;
var G__10147 = count__10134_10140;
var G__10148 = (i__10135_10141 + 1);
seq__10132_10138 = G__10145;
chunk__10133_10139 = G__10146;
count__10134_10140 = G__10147;
i__10135_10141 = G__10148;
continue;
}
} else
{var temp__4092__auto___10149 = cljs.core.seq.call(null,seq__10132_10138);if(temp__4092__auto___10149)
{var seq__10132_10150__$1 = temp__4092__auto___10149;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10132_10150__$1))
{var c__4150__auto___10151 = cljs.core.chunk_first.call(null,seq__10132_10150__$1);{
var G__10152 = cljs.core.chunk_rest.call(null,seq__10132_10150__$1);
var G__10153 = c__4150__auto___10151;
var G__10154 = cljs.core.count.call(null,c__4150__auto___10151);
var G__10155 = 0;
seq__10132_10138 = G__10152;
chunk__10133_10139 = G__10153;
count__10134_10140 = G__10154;
i__10135_10141 = G__10155;
continue;
}
} else
{var vec__10137_10156 = cljs.core.first.call(null,seq__10132_10150__$1);var ev__4336__auto___10157 = cljs.core.nth.call(null,vec__10137_10156,0,null);var func__4337__auto___10158 = cljs.core.nth.call(null,vec__10137_10156,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10157,func__4337__auto___10158);
{
var G__10159 = cljs.core.next.call(null,seq__10132_10150__$1);
var G__10160 = null;
var G__10161 = 0;
var G__10162 = 0;
seq__10132_10138 = G__10159;
chunk__10133_10139 = G__10160;
count__10134_10140 = G__10161;
i__10135_10141 = G__10162;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.tabs_and_search = (function tabs_and_search(this$){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.tabs","div.tabs",1324158509),lt.objs.plugins.tab.call(null,this$,new cljs.core.Keyword(null,"installed","installed",1042950892),"Installed"),lt.objs.plugins.tab.call(null,this$,new cljs.core.Keyword(null,"server","server",4403045045),"Available"),lt.objs.plugins.search_input.call(null,this$)], null));var seq__10169_10175 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,cljs.core.PersistentVector.EMPTY));var chunk__10170_10176 = null;var count__10171_10177 = 0;var i__10172_10178 = 0;while(true){
if((i__10172_10178 < count__10171_10177))
{var vec__10173_10179 = cljs.core._nth.call(null,chunk__10170_10176,i__10172_10178);var ev__4336__auto___10180 = cljs.core.nth.call(null,vec__10173_10179,0,null);var func__4337__auto___10181 = cljs.core.nth.call(null,vec__10173_10179,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10180,func__4337__auto___10181);
{
var G__10182 = seq__10169_10175;
var G__10183 = chunk__10170_10176;
var G__10184 = count__10171_10177;
var G__10185 = (i__10172_10178 + 1);
seq__10169_10175 = G__10182;
chunk__10170_10176 = G__10183;
count__10171_10177 = G__10184;
i__10172_10178 = G__10185;
continue;
}
} else
{var temp__4092__auto___10186 = cljs.core.seq.call(null,seq__10169_10175);if(temp__4092__auto___10186)
{var seq__10169_10187__$1 = temp__4092__auto___10186;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10169_10187__$1))
{var c__4150__auto___10188 = cljs.core.chunk_first.call(null,seq__10169_10187__$1);{
var G__10189 = cljs.core.chunk_rest.call(null,seq__10169_10187__$1);
var G__10190 = c__4150__auto___10188;
var G__10191 = cljs.core.count.call(null,c__4150__auto___10188);
var G__10192 = 0;
seq__10169_10175 = G__10189;
chunk__10170_10176 = G__10190;
count__10171_10177 = G__10191;
i__10172_10178 = G__10192;
continue;
}
} else
{var vec__10174_10193 = cljs.core.first.call(null,seq__10169_10187__$1);var ev__4336__auto___10194 = cljs.core.nth.call(null,vec__10174_10193,0,null);var func__4337__auto___10195 = cljs.core.nth.call(null,vec__10174_10193,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10194,func__4337__auto___10195);
{
var G__10196 = cljs.core.next.call(null,seq__10169_10187__$1);
var G__10197 = null;
var G__10198 = 0;
var G__10199 = 0;
seq__10169_10175 = G__10196;
chunk__10170_10176 = G__10197;
count__10171_10177 = G__10198;
i__10172_10178 = G__10199;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.source_button = (function source_button(plugin){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.source","span.source",4763361969),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"a","a",1013904339),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"href","href",1017115293),new cljs.core.Keyword(null,"url","url",1014020321).cljs$core$IFn$_invoke$arity$2(plugin,new cljs.core.Keyword(null,"source","source",4412365709).cljs$core$IFn$_invoke$arity$1(plugin))], null),"source"], null)], null));var seq__10206_10212 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (e){lt.util.dom.prevent.call(null,e);
lt.util.dom.stop_propagation.call(null,e);
return lt.objs.app.gui.Shell.openExternal(new cljs.core.Keyword(null,"url","url",1014020321).cljs$core$IFn$_invoke$arity$2(plugin,new cljs.core.Keyword(null,"source","source",4412365709).cljs$core$IFn$_invoke$arity$1(plugin)));
})], null)));var chunk__10207_10213 = null;var count__10208_10214 = 0;var i__10209_10215 = 0;while(true){
if((i__10209_10215 < count__10208_10214))
{var vec__10210_10216 = cljs.core._nth.call(null,chunk__10207_10213,i__10209_10215);var ev__4336__auto___10217 = cljs.core.nth.call(null,vec__10210_10216,0,null);var func__4337__auto___10218 = cljs.core.nth.call(null,vec__10210_10216,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10217,func__4337__auto___10218);
{
var G__10219 = seq__10206_10212;
var G__10220 = chunk__10207_10213;
var G__10221 = count__10208_10214;
var G__10222 = (i__10209_10215 + 1);
seq__10206_10212 = G__10219;
chunk__10207_10213 = G__10220;
count__10208_10214 = G__10221;
i__10209_10215 = G__10222;
continue;
}
} else
{var temp__4092__auto___10223 = cljs.core.seq.call(null,seq__10206_10212);if(temp__4092__auto___10223)
{var seq__10206_10224__$1 = temp__4092__auto___10223;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10206_10224__$1))
{var c__4150__auto___10225 = cljs.core.chunk_first.call(null,seq__10206_10224__$1);{
var G__10226 = cljs.core.chunk_rest.call(null,seq__10206_10224__$1);
var G__10227 = c__4150__auto___10225;
var G__10228 = cljs.core.count.call(null,c__4150__auto___10225);
var G__10229 = 0;
seq__10206_10212 = G__10226;
chunk__10207_10213 = G__10227;
count__10208_10214 = G__10228;
i__10209_10215 = G__10229;
continue;
}
} else
{var vec__10211_10230 = cljs.core.first.call(null,seq__10206_10224__$1);var ev__4336__auto___10231 = cljs.core.nth.call(null,vec__10211_10230,0,null);var func__4337__auto___10232 = cljs.core.nth.call(null,vec__10211_10230,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10231,func__4337__auto___10232);
{
var G__10233 = cljs.core.next.call(null,seq__10206_10224__$1);
var G__10234 = null;
var G__10235 = 0;
var G__10236 = 0;
seq__10206_10212 = G__10233;
chunk__10207_10213 = G__10234;
count__10208_10214 = G__10235;
i__10209_10215 = G__10236;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.update_button = (function update_button(plugin){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.update","span.update",526054239)], null));var seq__10243_10249 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (e){lt.util.dom.prevent.call(null,e);
lt.util.dom.stop_propagation.call(null,e);
return lt.objs.plugins.discover_deps.call(null,plugin,(function (){lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600));
return lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"refresh!","refresh!",4597922840));
}));
})], null)));var chunk__10244_10250 = null;var count__10245_10251 = 0;var i__10246_10252 = 0;while(true){
if((i__10246_10252 < count__10245_10251))
{var vec__10247_10253 = cljs.core._nth.call(null,chunk__10244_10250,i__10246_10252);var ev__4336__auto___10254 = cljs.core.nth.call(null,vec__10247_10253,0,null);var func__4337__auto___10255 = cljs.core.nth.call(null,vec__10247_10253,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10254,func__4337__auto___10255);
{
var G__10256 = seq__10243_10249;
var G__10257 = chunk__10244_10250;
var G__10258 = count__10245_10251;
var G__10259 = (i__10246_10252 + 1);
seq__10243_10249 = G__10256;
chunk__10244_10250 = G__10257;
count__10245_10251 = G__10258;
i__10246_10252 = G__10259;
continue;
}
} else
{var temp__4092__auto___10260 = cljs.core.seq.call(null,seq__10243_10249);if(temp__4092__auto___10260)
{var seq__10243_10261__$1 = temp__4092__auto___10260;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10243_10261__$1))
{var c__4150__auto___10262 = cljs.core.chunk_first.call(null,seq__10243_10261__$1);{
var G__10263 = cljs.core.chunk_rest.call(null,seq__10243_10261__$1);
var G__10264 = c__4150__auto___10262;
var G__10265 = cljs.core.count.call(null,c__4150__auto___10262);
var G__10266 = 0;
seq__10243_10249 = G__10263;
chunk__10244_10250 = G__10264;
count__10245_10251 = G__10265;
i__10246_10252 = G__10266;
continue;
}
} else
{var vec__10248_10267 = cljs.core.first.call(null,seq__10243_10261__$1);var ev__4336__auto___10268 = cljs.core.nth.call(null,vec__10248_10267,0,null);var func__4337__auto___10269 = cljs.core.nth.call(null,vec__10248_10267,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10268,func__4337__auto___10269);
{
var G__10270 = cljs.core.next.call(null,seq__10243_10261__$1);
var G__10271 = null;
var G__10272 = 0;
var G__10273 = 0;
seq__10243_10249 = G__10270;
chunk__10244_10250 = G__10271;
count__10245_10251 = G__10272;
i__10246_10252 = G__10273;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.install_button = (function install_button(plugin){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.install","span.install",967456361)], null));var seq__10280_10286 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (e){var me_10290 = this;lt.objs.plugins.discover_deps.call(null,plugin,((function (me_10290){
return (function (){lt.util.dom.remove.call(null,lt.util.dom.parent.call(null,me_10290));
lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600));
return lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"refresh!","refresh!",4597922840));
});})(me_10290))
);
lt.util.dom.prevent.call(null,e);
return lt.util.dom.stop_propagation.call(null,e);
})], null)));var chunk__10281_10287 = null;var count__10282_10288 = 0;var i__10283_10289 = 0;while(true){
if((i__10283_10289 < count__10282_10288))
{var vec__10284_10291 = cljs.core._nth.call(null,chunk__10281_10287,i__10283_10289);var ev__4336__auto___10292 = cljs.core.nth.call(null,vec__10284_10291,0,null);var func__4337__auto___10293 = cljs.core.nth.call(null,vec__10284_10291,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10292,func__4337__auto___10293);
{
var G__10294 = seq__10280_10286;
var G__10295 = chunk__10281_10287;
var G__10296 = count__10282_10288;
var G__10297 = (i__10283_10289 + 1);
seq__10280_10286 = G__10294;
chunk__10281_10287 = G__10295;
count__10282_10288 = G__10296;
i__10283_10289 = G__10297;
continue;
}
} else
{var temp__4092__auto___10298 = cljs.core.seq.call(null,seq__10280_10286);if(temp__4092__auto___10298)
{var seq__10280_10299__$1 = temp__4092__auto___10298;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10280_10299__$1))
{var c__4150__auto___10300 = cljs.core.chunk_first.call(null,seq__10280_10299__$1);{
var G__10301 = cljs.core.chunk_rest.call(null,seq__10280_10299__$1);
var G__10302 = c__4150__auto___10300;
var G__10303 = cljs.core.count.call(null,c__4150__auto___10300);
var G__10304 = 0;
seq__10280_10286 = G__10301;
chunk__10281_10287 = G__10302;
count__10282_10288 = G__10303;
i__10283_10289 = G__10304;
continue;
}
} else
{var vec__10285_10305 = cljs.core.first.call(null,seq__10280_10299__$1);var ev__4336__auto___10306 = cljs.core.nth.call(null,vec__10285_10305,0,null);var func__4337__auto___10307 = cljs.core.nth.call(null,vec__10285_10305,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10306,func__4337__auto___10307);
{
var G__10308 = cljs.core.next.call(null,seq__10280_10299__$1);
var G__10309 = null;
var G__10310 = 0;
var G__10311 = 0;
seq__10280_10286 = G__10308;
chunk__10281_10287 = G__10309;
count__10282_10288 = G__10310;
i__10283_10289 = G__10311;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.server_plugin_ui = (function server_plugin_ui(plugin){var e__4335__auto__ = crate.core.html.call(null,(function (){var info = new cljs.core.Keyword(null,"info","info",1017141280).cljs$core$IFn$_invoke$arity$1(plugin);var ver = new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(info);var installed = cljs.core.get.call(null,new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.app.app)),new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(info));var update_QMARK_ = (function (){var and__3396__auto__ = new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(installed);if(cljs.core.truth_(and__3396__auto__))
{return lt.objs.deploy.is_newer_QMARK_.call(null,new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(installed),ver);
} else
{return and__3396__auto__;
}
})();return new cljs.core.PersistentVector(null, 7, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"li","li",1013907695),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",1108647146),(cljs.core.truth_(update_QMARK_)?"has-update":null)], null),((cljs.core.not.call(null,installed))?lt.objs.plugins.install_button.call(null,plugin):(cljs.core.truth_(update_QMARK_)?lt.objs.plugins.update_button.call(null,plugin):new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.installed","span.installed",3622134088)], null))),lt.objs.plugins.source_button.call(null,plugin),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h1","h1",1013907515),new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(info),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.version","span.version",3656461734),ver], null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h3","h3",1013907517),new cljs.core.Keyword(null,"author","author",3902543101).cljs$core$IFn$_invoke$arity$1(info)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"p","p",1013904354),new cljs.core.Keyword(null,"desc","desc",1016984067).cljs$core$IFn$_invoke$arity$1(info)], null)], null);
})());var seq__10318_10324 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,cljs.core.PersistentVector.EMPTY));var chunk__10319_10325 = null;var count__10320_10326 = 0;var i__10321_10327 = 0;while(true){
if((i__10321_10327 < count__10320_10326))
{var vec__10322_10328 = cljs.core._nth.call(null,chunk__10319_10325,i__10321_10327);var ev__4336__auto___10329 = cljs.core.nth.call(null,vec__10322_10328,0,null);var func__4337__auto___10330 = cljs.core.nth.call(null,vec__10322_10328,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10329,func__4337__auto___10330);
{
var G__10331 = seq__10318_10324;
var G__10332 = chunk__10319_10325;
var G__10333 = count__10320_10326;
var G__10334 = (i__10321_10327 + 1);
seq__10318_10324 = G__10331;
chunk__10319_10325 = G__10332;
count__10320_10326 = G__10333;
i__10321_10327 = G__10334;
continue;
}
} else
{var temp__4092__auto___10335 = cljs.core.seq.call(null,seq__10318_10324);if(temp__4092__auto___10335)
{var seq__10318_10336__$1 = temp__4092__auto___10335;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10318_10336__$1))
{var c__4150__auto___10337 = cljs.core.chunk_first.call(null,seq__10318_10336__$1);{
var G__10338 = cljs.core.chunk_rest.call(null,seq__10318_10336__$1);
var G__10339 = c__4150__auto___10337;
var G__10340 = cljs.core.count.call(null,c__4150__auto___10337);
var G__10341 = 0;
seq__10318_10324 = G__10338;
chunk__10319_10325 = G__10339;
count__10320_10326 = G__10340;
i__10321_10327 = G__10341;
continue;
}
} else
{var vec__10323_10342 = cljs.core.first.call(null,seq__10318_10336__$1);var ev__4336__auto___10343 = cljs.core.nth.call(null,vec__10323_10342,0,null);var func__4337__auto___10344 = cljs.core.nth.call(null,vec__10323_10342,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10343,func__4337__auto___10344);
{
var G__10345 = cljs.core.next.call(null,seq__10318_10336__$1);
var G__10346 = null;
var G__10347 = 0;
var G__10348 = 0;
seq__10318_10324 = G__10345;
chunk__10319_10325 = G__10346;
count__10320_10326 = G__10347;
i__10321_10327 = G__10348;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.uninstall_button = (function uninstall_button(plugin){var e__4335__auto__ = crate.core.html.call(null,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.uninstall","span.uninstall",2967491248)], null));var seq__10355_10361 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"click","click",1108654330),(function (){return lt.objs.popup.popup_BANG_.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"header","header",4087600639),"Uninstall plugin?",new cljs.core.Keyword(null,"body","body",1016933652),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),"This will delete the plugin from your system, removing any local\n                                 changes you may have made, and cannot be undone."], null),new cljs.core.Keyword(null,"buttons","buttons",1255256819),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"label","label",1116631654),"Delete plugin",new cljs.core.Keyword(null,"action","action",3885920680),(function (){return lt.objs.plugins.uninstall.call(null,plugin);
})], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1116631654),"Cancel"], null)], null)], null));
})], null)));var chunk__10356_10362 = null;var count__10357_10363 = 0;var i__10358_10364 = 0;while(true){
if((i__10358_10364 < count__10357_10363))
{var vec__10359_10365 = cljs.core._nth.call(null,chunk__10356_10362,i__10358_10364);var ev__4336__auto___10366 = cljs.core.nth.call(null,vec__10359_10365,0,null);var func__4337__auto___10367 = cljs.core.nth.call(null,vec__10359_10365,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10366,func__4337__auto___10367);
{
var G__10368 = seq__10355_10361;
var G__10369 = chunk__10356_10362;
var G__10370 = count__10357_10363;
var G__10371 = (i__10358_10364 + 1);
seq__10355_10361 = G__10368;
chunk__10356_10362 = G__10369;
count__10357_10363 = G__10370;
i__10358_10364 = G__10371;
continue;
}
} else
{var temp__4092__auto___10372 = cljs.core.seq.call(null,seq__10355_10361);if(temp__4092__auto___10372)
{var seq__10355_10373__$1 = temp__4092__auto___10372;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10355_10373__$1))
{var c__4150__auto___10374 = cljs.core.chunk_first.call(null,seq__10355_10373__$1);{
var G__10375 = cljs.core.chunk_rest.call(null,seq__10355_10373__$1);
var G__10376 = c__4150__auto___10374;
var G__10377 = cljs.core.count.call(null,c__4150__auto___10374);
var G__10378 = 0;
seq__10355_10361 = G__10375;
chunk__10356_10362 = G__10376;
count__10357_10363 = G__10377;
i__10358_10364 = G__10378;
continue;
}
} else
{var vec__10360_10379 = cljs.core.first.call(null,seq__10355_10373__$1);var ev__4336__auto___10380 = cljs.core.nth.call(null,vec__10360_10379,0,null);var func__4337__auto___10381 = cljs.core.nth.call(null,vec__10360_10379,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10380,func__4337__auto___10381);
{
var G__10382 = cljs.core.next.call(null,seq__10355_10373__$1);
var G__10383 = null;
var G__10384 = 0;
var G__10385 = 0;
seq__10355_10361 = G__10382;
chunk__10356_10362 = G__10383;
count__10357_10363 = G__10384;
i__10358_10364 = G__10385;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.objs.plugins.installed_plugin_ui = (function installed_plugin_ui(plugin){var e__4335__auto__ = crate.core.html.call(null,(function (){var cached = cljs.core.get.call(null,new cljs.core.Keyword(null,"version-cache","version-cache",684446143).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.plugins.manager)),new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin));var update_QMARK_ = (cljs.core.truth_(cached)?lt.objs.deploy.is_newer_QMARK_.call(null,new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(plugin),cached):null);return new cljs.core.PersistentVector(null, 8, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"li","li",1013907695),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",1108647146),(cljs.core.truth_(update_QMARK_)?"has-update":null)], null),(cljs.core.truth_(update_QMARK_)?lt.objs.plugins.update_button.call(null,cljs.core.assoc.call(null,plugin,new cljs.core.Keyword(null,"version","version",1365512266),cached)):null),lt.objs.plugins.uninstall_button.call(null,plugin),lt.objs.plugins.source_button.call(null,plugin),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h1","h1",1013907515),new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.version","span.version",3656461734),new cljs.core.Keyword(null,"version","version",1365512266).cljs$core$IFn$_invoke$arity$1(plugin)], null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h3","h3",1013907517),new cljs.core.Keyword(null,"author","author",3902543101).cljs$core$IFn$_invoke$arity$1(plugin)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"p","p",1013904354),new cljs.core.Keyword(null,"desc","desc",1016984067).cljs$core$IFn$_invoke$arity$1(plugin)], null)], null);
})());var seq__10392_10398 = cljs.core.seq.call(null,cljs.core.partition.call(null,2,cljs.core.PersistentVector.EMPTY));var chunk__10393_10399 = null;var count__10394_10400 = 0;var i__10395_10401 = 0;while(true){
if((i__10395_10401 < count__10394_10400))
{var vec__10396_10402 = cljs.core._nth.call(null,chunk__10393_10399,i__10395_10401);var ev__4336__auto___10403 = cljs.core.nth.call(null,vec__10396_10402,0,null);var func__4337__auto___10404 = cljs.core.nth.call(null,vec__10396_10402,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10403,func__4337__auto___10404);
{
var G__10405 = seq__10392_10398;
var G__10406 = chunk__10393_10399;
var G__10407 = count__10394_10400;
var G__10408 = (i__10395_10401 + 1);
seq__10392_10398 = G__10405;
chunk__10393_10399 = G__10406;
count__10394_10400 = G__10407;
i__10395_10401 = G__10408;
continue;
}
} else
{var temp__4092__auto___10409 = cljs.core.seq.call(null,seq__10392_10398);if(temp__4092__auto___10409)
{var seq__10392_10410__$1 = temp__4092__auto___10409;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10392_10410__$1))
{var c__4150__auto___10411 = cljs.core.chunk_first.call(null,seq__10392_10410__$1);{
var G__10412 = cljs.core.chunk_rest.call(null,seq__10392_10410__$1);
var G__10413 = c__4150__auto___10411;
var G__10414 = cljs.core.count.call(null,c__4150__auto___10411);
var G__10415 = 0;
seq__10392_10398 = G__10412;
chunk__10393_10399 = G__10413;
count__10394_10400 = G__10414;
i__10395_10401 = G__10415;
continue;
}
} else
{var vec__10397_10416 = cljs.core.first.call(null,seq__10392_10410__$1);var ev__4336__auto___10417 = cljs.core.nth.call(null,vec__10397_10416,0,null);var func__4337__auto___10418 = cljs.core.nth.call(null,vec__10397_10416,1,null);lt.util.dom.on.call(null,e__4335__auto__,ev__4336__auto___10417,func__4337__auto___10418);
{
var G__10419 = cljs.core.next.call(null,seq__10392_10410__$1);
var G__10420 = null;
var G__10421 = 0;
var G__10422 = 0;
seq__10392_10398 = G__10419;
chunk__10393_10399 = G__10420;
count__10394_10400 = G__10421;
i__10395_10401 = G__10422;
continue;
}
}
} else
{}
}
break;
}
return e__4335__auto__;
});
lt.object.object_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","plugin-manager","lt.objs.plugins/plugin-manager",2152899846),new cljs.core.Keyword(null,"tags","tags",1017456523),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"plugin-manager","plugin-manager",1960276613),null], null), null),new cljs.core.Keyword(null,"name","name",1017277949),"Plugins",new cljs.core.Keyword(null,"tab","tab",1014018823),new cljs.core.Keyword(null,"installed","installed",1042950892),new cljs.core.Keyword(null,"init","init",1017141378),(function (this$){return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",1108647146),crate.binding.bound.call(null,this$,(function (p1__10423_SHARP_){return [cljs.core.str("plugin-manager"),cljs.core.str(((cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"tab","tab",1014018823).cljs$core$IFn$_invoke$arity$1(p1__10423_SHARP_),new cljs.core.Keyword(null,"server","server",4403045045)))?" server":null))].join('');
}))], null),lt.objs.plugins.tabs_and_search.call(null,this$),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"ul.server-plugins","ul.server-plugins",2509222591)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"ul.plugins","ul.plugins",4244308667)], null)], null);
}));
lt.objs.plugins.manager = lt.object.create.call(null,new cljs.core.Keyword("lt.objs.plugins","plugin-manager","lt.objs.plugins/plugin-manager",2152899846));
lt.objs.plugins.__BEH__update_server_plugins = (function __BEH__update_server_plugins(this$){lt.objs.notifos.working.call(null,"Fetching available plugins...");
fetch.core.xhr.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"post","post",1017351186),[cljs.core.str(lt.objs.plugins.plugins_url),cljs.core.str("/versions")].join('')], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"names","names",1118489274),cljs.core.pr_str.call(null,cljs.core.vec.call(null,cljs.core.keys.call(null,new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.app.app)))))], null),(function (data){var cache = lt.objs.plugins.EOF_read.call(null,data);if(cljs.core._EQ_.call(null,cache,new cljs.core.Keyword(null,"version-cache","version-cache",684446143).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$))))
{return null;
} else
{lt.object.merge_BANG_.call(null,this$,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"version-cache","version-cache",684446143),cache], null));
return lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"refresh!","refresh!",4597922840));
}
}));
return fetch.core.xhr.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"get","get",1014006472),lt.objs.plugins.plugins_url], null),cljs.core.PersistentArrayMap.EMPTY,(function (data){lt.objs.notifos.done_working.call(null,"");
if(cljs.core.truth_(data))
{return lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"plugin-results","plugin-results",2222563022),lt.objs.plugins.EOF_read.call(null,data));
} else
{return null;
}
}));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","update-server-plugins","lt.objs.plugins/update-server-plugins",915564269),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__update_server_plugins,new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugin Manager: fetch plugins",new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"fetch-plugins","fetch-plugins",2680814335),null], null), null));
lt.objs.plugins.__BEH__render_server_plugins = (function __BEH__render_server_plugins(this$,plugins){var ul = lt.util.dom.$.call(null,new cljs.core.Keyword(null,".server-plugins",".server-plugins",2388894262),lt.object.__GT_content.call(null,this$));lt.util.dom.empty.call(null,ul);
return lt.util.dom.append.call(null,ul,lt.util.dom.fragment.call(null,cljs.core.map.call(null,lt.objs.plugins.server_plugin_ui,cljs.core.remove.call(null,(function (p1__10424_SHARP_){return lt.objs.plugins.installed_QMARK_.call(null,new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"info","info",1017141280).cljs$core$IFn$_invoke$arity$1(p1__10424_SHARP_)));
}),plugins))));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","render-server-plugins","lt.objs.plugins/render-server-plugins",797162336),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__render_server_plugins,new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugin Manager: render plugin results",new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"plugin-results","plugin-results",2222563022),null], null), null));
lt.objs.plugins.__BEH__submit_plugin = (function __BEH__submit_plugin(this$,url){lt.objs.notifos.working.call(null,[cljs.core.str("Submitting plugin: "),cljs.core.str(url)].join(''));
return fetch.core.xhr.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"post","post",1017351186),[cljs.core.str(lt.objs.plugins.plugins_url),cljs.core.str("/add")].join('')], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"url","url",1014020321),url], null),(function (data){lt.objs.notifos.done_working.call(null,"");
var data__$1 = lt.objs.plugins.EOF_read.call(null,data);return lt.objs.popup.popup_BANG_.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"header","header",4087600639),(function (){var pred__10428 = cljs.core._EQ_;var expr__10429 = new cljs.core.Keyword(null,"status","status",4416389988).cljs$core$IFn$_invoke$arity$1(data__$1);if(cljs.core.truth_(pred__10428.call(null,new cljs.core.Keyword(null,"success","success",3441701749),expr__10429)))
{return "Plugin added!";
} else
{if(cljs.core.truth_(pred__10428.call(null,new cljs.core.Keyword(null,"error","error",1110689146),expr__10429)))
{return "There's a problem with the plugin.";
} else
{if(cljs.core.truth_(pred__10428.call(null,new cljs.core.Keyword(null,"refresh","refresh",2099349069),expr__10429)))
{return "Plugin refreshed!";
} else
{throw (new Error([cljs.core.str("No matching clause: "),cljs.core.str(expr__10429)].join('')));
}
}
}
})(),new cljs.core.Keyword(null,"body","body",1016933652),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),((cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"status","status",4416389988).cljs$core$IFn$_invoke$arity$1(data__$1),new cljs.core.Keyword(null,"error","error",1110689146)))?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),"Url submitted: ",url], null):null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"p","p",1013904354),new cljs.core.Keyword(null,"description","description",3584325486).cljs$core$IFn$_invoke$arity$1(data__$1)], null)], null),new cljs.core.Keyword(null,"buttons","buttons",1255256819),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1116631654),"ok"], null)], null)], null));
}));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","submit-plugin","lt.objs.plugins/submit-plugin",3925857683),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__submit_plugin,new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugin Manager: submit a new plugin",new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"submit-plugin!","submit-plugin!",2477848075),null], null), null));
lt.objs.plugins.__BEH__search_server_plugins = (function __BEH__search_server_plugins(this$,search){if(cljs.core.empty_QMARK_.call(null,search))
{return lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"fetch-plugins","fetch-plugins",2680814335));
} else
{lt.objs.notifos.working.call(null,[cljs.core.str("Searching plugins for: "),cljs.core.str(search)].join(''));
return fetch.core.xhr.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"post","post",1017351186),[cljs.core.str(lt.objs.plugins.plugins_url),cljs.core.str("/search")].join('')], null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"term","term",1017460702),search], null),(function (data){lt.objs.notifos.done_working.call(null,"");
if(cljs.core.truth_(data))
{return lt.object.raise.call(null,this$,new cljs.core.Keyword(null,"plugin-results","plugin-results",2222563022),lt.objs.plugins.EOF_read.call(null,data));
} else
{return null;
}
}));
}
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","search-server-plugins","lt.objs.plugins/search-server-plugins",2575945774),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__search_server_plugins,new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugin Manager: search plugins",new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"search-plugins!","search-plugins!",4139281016),null], null), null));
lt.objs.plugins.__BEH__render_installed_plugins = (function __BEH__render_installed_plugins(this$,plugins){lt.object.merge_BANG_.call(null,lt.objs.app.app,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683),lt.objs.plugins.available_plugins.call(null)], null));
var ul = lt.util.dom.$.call(null,new cljs.core.Keyword(null,".plugins",".plugins",3398138660),lt.object.__GT_content.call(null,this$));lt.util.dom.empty.call(null,ul);
return lt.util.dom.append.call(null,ul,lt.util.dom.fragment.call(null,cljs.core.map.call(null,lt.objs.plugins.installed_plugin_ui,cljs.core.sort_by.call(null,new cljs.core.Keyword(null,"name","name",1017277949),cljs.core.vals.call(null,new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.app.app)))))));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","render-installed-plugins","lt.objs.plugins/render-installed-plugins",560702913),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__render_installed_plugins,new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugin Manager: refresh installed plugins",new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"refresh!","refresh!",4597922840),null], null), null));
lt.objs.plugins.__BEH__on_close = (function __BEH__on_close(this$){return lt.objs.tabs.rem_BANG_.call(null,this$);
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","on-close","lt.objs.plugins/on-close",1621607293),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__on_close,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"close","close",1108660586),null], null), null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"plugin-manager.submit","plugin-manager.submit",4131049157),new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugins: Submit a plugin",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){return lt.objs.plugins.submit_url.call(null);
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"plugin-manager.search","plugin-manager.search",4116247637),new cljs.core.Keyword(null,"hidden","hidden",4091384092),true,new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugins: Search",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (term){var term__$1 = (function (){var or__3408__auto__ = term;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return lt.util.dom.val.call(null,lt.util.dom.$.call(null,new cljs.core.Keyword(null,"input","input",1114262332),lt.object.__GT_content.call(null,lt.objs.plugins.manager)));
}
})();lt.object.merge_BANG_.call(null,lt.objs.plugins.manager,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"tab","tab",1014018823),new cljs.core.Keyword(null,"server","server",4403045045)], null));
return lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"search-plugins!","search-plugins!",4139281016),term__$1);
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"plugin-manager.refresh","plugin-manager.refresh",1814385266),new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugins: Refresh plugin list",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"refresh!","refresh!",4597922840));
return lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"fetch-plugins","fetch-plugins",2680814335));
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"plugin-manager.show","plugin-manager.show",3752328298),new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugins: Show plugin manager",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){lt.objs.tabs.add_or_focus_BANG_.call(null,lt.objs.plugins.manager);
return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"plugin-manager.refresh","plugin-manager.refresh",1814385266));
})], null));
lt.objs.command.command.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"command","command",1964298941),new cljs.core.Keyword(null,"plugin-manager.update-outdated","plugin-manager.update-outdated",1387765507),new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugins: Update all outdated",new cljs.core.Keyword(null,"exec","exec",1017031683),(function (){var outdated = cljs.core.filter.call(null,lt.objs.plugins.outdated_QMARK_,cljs.core.vals.call(null,new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.app.app))));var names = cljs.core.atom.call(null,cljs.core.PersistentHashSet.EMPTY);var countdown = cljs.core.atom.call(null,cljs.core.count.call(null,outdated));var seq__10431 = cljs.core.seq.call(null,outdated);var chunk__10434 = null;var count__10435 = 0;var i__10436 = 0;while(true){
if((i__10436 < count__10435))
{var plugin = cljs.core._nth.call(null,chunk__10434,i__10436);if(cljs.core.seq.call(null,outdated))
{var cached_10439 = cljs.core.get.call(null,new cljs.core.Keyword(null,"version-cache","version-cache",684446143).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.plugins.manager)),new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin));lt.objs.plugins.discover_deps.call(null,cljs.core.assoc.call(null,plugin,new cljs.core.Keyword(null,"version","version",1365512266),cached_10439),((function (seq__10431,chunk__10434,count__10435,i__10436,cached_10439,plugin){
return (function (){cljs.core.swap_BANG_.call(null,names,cljs.core.conj,new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin));
cljs.core.swap_BANG_.call(null,countdown,cljs.core.dec);
lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"refresh!","refresh!",4597922840));
if((cljs.core.deref.call(null,countdown) <= 0))
{lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600));
return lt.objs.notifos.set_msg_BANG_.call(null,cljs.core.apply.call(null,cljs.core.str,"Updated: ",cljs.core.interpose.call(null,", ",cljs.core.deref.call(null,names))));
} else
{return null;
}
});})(seq__10431,chunk__10434,count__10435,i__10436,cached_10439,plugin))
);
{
var G__10440 = seq__10431;
var G__10441 = chunk__10434;
var G__10442 = count__10435;
var G__10443 = (i__10436 + 1);
seq__10431 = G__10440;
chunk__10434 = G__10441;
count__10435 = G__10442;
i__10436 = G__10443;
continue;
}
} else
{{
var G__10444 = seq__10431;
var G__10445 = chunk__10434;
var G__10446 = count__10435;
var G__10447 = (i__10436 + 1);
seq__10431 = G__10444;
chunk__10434 = G__10445;
count__10435 = G__10446;
i__10436 = G__10447;
continue;
}
}
} else
{var temp__4092__auto__ = cljs.core.seq.call(null,seq__10431);if(temp__4092__auto__)
{var seq__10431__$1 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10431__$1))
{var c__4150__auto__ = cljs.core.chunk_first.call(null,seq__10431__$1);{
var G__10448 = cljs.core.chunk_rest.call(null,seq__10431__$1);
var G__10449 = c__4150__auto__;
var G__10450 = cljs.core.count.call(null,c__4150__auto__);
var G__10451 = 0;
seq__10431 = G__10448;
chunk__10434 = G__10449;
count__10435 = G__10450;
i__10436 = G__10451;
continue;
}
} else
{var plugin = cljs.core.first.call(null,seq__10431__$1);if(cljs.core.seq.call(null,outdated))
{var cached_10452 = cljs.core.get.call(null,new cljs.core.Keyword(null,"version-cache","version-cache",684446143).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,lt.objs.plugins.manager)),new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin));lt.objs.plugins.discover_deps.call(null,cljs.core.assoc.call(null,plugin,new cljs.core.Keyword(null,"version","version",1365512266),cached_10452),((function (seq__10431,chunk__10434,count__10435,i__10436,cached_10452,plugin,seq__10431__$1,temp__4092__auto__){
return (function (){cljs.core.swap_BANG_.call(null,names,cljs.core.conj,new cljs.core.Keyword(null,"name","name",1017277949).cljs$core$IFn$_invoke$arity$1(plugin));
cljs.core.swap_BANG_.call(null,countdown,cljs.core.dec);
lt.object.raise.call(null,lt.objs.plugins.manager,new cljs.core.Keyword(null,"refresh!","refresh!",4597922840));
if((cljs.core.deref.call(null,countdown) <= 0))
{lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"behaviors.reload","behaviors.reload",2942796600));
return lt.objs.notifos.set_msg_BANG_.call(null,cljs.core.apply.call(null,cljs.core.str,"Updated: ",cljs.core.interpose.call(null,", ",cljs.core.deref.call(null,names))));
} else
{return null;
}
});})(seq__10431,chunk__10434,count__10435,i__10436,cached_10452,plugin,seq__10431__$1,temp__4092__auto__))
);
{
var G__10453 = cljs.core.next.call(null,seq__10431__$1);
var G__10454 = null;
var G__10455 = 0;
var G__10456 = 0;
seq__10431 = G__10453;
chunk__10434 = G__10454;
count__10435 = G__10455;
i__10436 = G__10456;
continue;
}
} else
{{
var G__10457 = cljs.core.next.call(null,seq__10431__$1);
var G__10458 = null;
var G__10459 = 0;
var G__10460 = 0;
seq__10431 = G__10457;
chunk__10434 = G__10458;
count__10435 = G__10459;
i__10436 = G__10460;
continue;
}
}
}
} else
{return null;
}
}
break;
}
})], null));
lt.objs.plugins.__BEH__init_plugins = (function __BEH__init_plugins(app){if(cljs.core.truth_(lt.objs.files.exists_QMARK_.call(null,lt.objs.plugins.user_plugins_dir)))
{} else
{lt.objs.files.mkdir.call(null,lt.objs.plugins.user_plugins_dir);
}
return lt.object.merge_BANG_.call(null,lt.objs.app.app,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683),lt.objs.plugins.available_plugins.call(null)], null));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","init-plugins","lt.objs.plugins/init-plugins",4096325174),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__init_plugins,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"pre-load","pre-load",3967767874),null], null), null));
lt.objs.plugins.__BEH__behaviors__DOT__refreshed_load_keys = (function __BEH__behaviors__DOT__refreshed_load_keys(){return lt.objs.command.exec_BANG_.call(null,new cljs.core.Keyword(null,"keymaps.reload","keymaps.reload",666881155));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","behaviors.refreshed-load-keys","lt.objs.plugins/behaviors.refreshed-load-keys",1002486638),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__behaviors__DOT__refreshed_load_keys,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"behaviors.refreshed","behaviors.refreshed",1338765023),null], null), null));
lt.objs.plugins.__BEH__plugin_behavior_diffs = (function __BEH__plugin_behavior_diffs(this$,diffs){var plugins = new cljs.core.Keyword("lt.objs.plugins","plugins","lt.objs.plugins/plugins",2920328683).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$));var dep_graph = lt.objs.plugins.plugin_dependency_graph.call(null,plugins);var dep_ordered = cljs.core.seq.call(null,cljs.core.reverse.call(null,lt.util.kahn.kahn_sort.call(null,dep_graph)));var mapped = ((dep_ordered)?cljs.core.map.call(null,plugins,dep_ordered):cljs.core.vals.call(null,plugins));if(cljs.core.truth_((function (){var and__3396__auto__ = plugins;if(cljs.core.truth_(and__3396__auto__))
{return (cljs.core.not.call(null,dep_ordered)) && (cljs.core.not.call(null,new cljs.core.Keyword("lt.objs.plugins","cycle-warned","lt.objs.plugins/cycle-warned",1103523743).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$))));
} else
{return and__3396__auto__;
}
})()))
{lt.object.merge_BANG_.call(null,this$,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("lt.objs.plugins","cycle-warned","lt.objs.plugins/cycle-warned",1103523743),true], null));
lt.objs.popup.popup_BANG_.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"header","header",4087600639),"There's a cycle in your plugin dependencies.",new cljs.core.Keyword(null,"body","body",1016933652),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1014003715),"As a result, we can't come up with an optimal way to load them.\n                                                This means there may be unexpected consequences to being loaded out of order.\n                                                Here are the plugins causing the cycle: ",lt.objs.plugins.cycle_desc.call(null,lt.objs.plugins.__GT_cycles.call(null,dep_graph))], null),new cljs.core.Keyword(null,"buttons","buttons",1255256819),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1116631654),"ok"], null)], null)], null));
} else
{}
return cljs.core.concat.call(null,diffs,cljs.core.mapv.call(null,lt.objs.plugins.plugin_behaviors,mapped));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","plugin-behavior-diffs","lt.objs.plugins/plugin-behavior-diffs",1511349728),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__plugin_behavior_diffs,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"behaviors.diffs.plugin+","behaviors.diffs.plugin+",2303858461),null], null), null));
lt.objs.plugins.__BEH__plugin_keymap_diffs = (function __BEH__plugin_keymap_diffs(this$,diffs){return cljs.core.concat.call(null,diffs,cljs.core.filter.call(null,cljs.core.identity,cljs.core.mapv.call(null,lt.objs.settings.parse_key_file,new cljs.core.Keyword("lt.objs.plugins","keymaps","lt.objs.plugins/keymaps",4718281889).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$)))));
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","plugin-keymap-diffs","lt.objs.plugins/plugin-keymap-diffs",4431416675),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__plugin_keymap_diffs,new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"keymap.diffs.plugin+","keymap.diffs.plugin+",4109982809),null], null), null));
lt.objs.plugins.__BEH__load_js = (function __BEH__load_js(this$,path){var _STAR_plugin_dir_STAR_10470 = lt.objs.plugins._STAR_plugin_dir_STAR_;var _STAR_force_reload_STAR_10471 = lt.util.load._STAR_force_reload_STAR_;try{lt.objs.plugins._STAR_plugin_dir_STAR_ = new cljs.core.Keyword("lt.objs.plugins","dir","lt.objs.plugins/dir",3366558592).cljs$core$IFn$_invoke$arity$1(lt.object._STAR_behavior_meta_STAR_);
lt.util.load._STAR_force_reload_STAR_ = new cljs.core.Keyword("lt.objs.plugins","force-reload","lt.objs.plugins/force-reload",4731263182).cljs$core$IFn$_invoke$arity$1(lt.object._STAR_behavior_meta_STAR_);
var paths = ((cljs.core.coll_QMARK_.call(null,path))?path:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [path], null));var seq__10472 = cljs.core.seq.call(null,paths);var chunk__10473 = null;var count__10474 = 0;var i__10475 = 0;while(true){
if((i__10475 < count__10474))
{var path__$1 = cljs.core._nth.call(null,chunk__10473,i__10475);var path_10478__$2 = lt.objs.plugins.adjust_path.call(null,path__$1);if(cljs.core.truth_((function (){var or__3408__auto__ = lt.util.load._STAR_force_reload_STAR_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.not.call(null,cljs.core.get.call(null,new cljs.core.Keyword("lt.objs.plugins","loaded-files","lt.objs.plugins/loaded-files",2343697626).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$)),path_10478__$2));
}
})()))
{try{lt.util.load.js.call(null,path_10478__$2,true);
lt.object.update_BANG_.call(null,this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","loaded-files","lt.objs.plugins/loaded-files",2343697626)], null),((function (seq__10472,chunk__10473,count__10474,i__10475,path_10478__$2,path__$1){
return (function (p1__10461_SHARP_){return cljs.core.conj.call(null,(function (){var or__3408__auto__ = p1__10461_SHARP_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.PersistentHashSet.EMPTY;
}
})(),path_10478__$2);
});})(seq__10472,chunk__10473,count__10474,i__10475,path_10478__$2,path__$1))
);
}catch (e10476){if((e10476 instanceof Error))
{var e_10479 = e10476;console.error([cljs.core.str("Error loading JS file: "),cljs.core.str(path_10478__$2),cljs.core.str(" : "),cljs.core.str(e_10479)].join(''));
console.error(e_10479.stack);
} else
{if((e10476 instanceof global.Error))
{var e_10480 = e10476;console.error([cljs.core.str("Error loading JS file: "),cljs.core.str(path_10478__$2),cljs.core.str(" : "),cljs.core.str(e_10480)].join(''));
console.error(e_10480.stack);
} else
{if(new cljs.core.Keyword(null,"else","else",1017020587))
{throw e10476;
} else
{}
}
}
}} else
{}
{
var G__10481 = seq__10472;
var G__10482 = chunk__10473;
var G__10483 = count__10474;
var G__10484 = (i__10475 + 1);
seq__10472 = G__10481;
chunk__10473 = G__10482;
count__10474 = G__10483;
i__10475 = G__10484;
continue;
}
} else
{var temp__4092__auto__ = cljs.core.seq.call(null,seq__10472);if(temp__4092__auto__)
{var seq__10472__$1 = temp__4092__auto__;if(cljs.core.chunked_seq_QMARK_.call(null,seq__10472__$1))
{var c__4150__auto__ = cljs.core.chunk_first.call(null,seq__10472__$1);{
var G__10485 = cljs.core.chunk_rest.call(null,seq__10472__$1);
var G__10486 = c__4150__auto__;
var G__10487 = cljs.core.count.call(null,c__4150__auto__);
var G__10488 = 0;
seq__10472 = G__10485;
chunk__10473 = G__10486;
count__10474 = G__10487;
i__10475 = G__10488;
continue;
}
} else
{var path__$1 = cljs.core.first.call(null,seq__10472__$1);var path_10489__$2 = lt.objs.plugins.adjust_path.call(null,path__$1);if(cljs.core.truth_((function (){var or__3408__auto__ = lt.util.load._STAR_force_reload_STAR_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.not.call(null,cljs.core.get.call(null,new cljs.core.Keyword("lt.objs.plugins","loaded-files","lt.objs.plugins/loaded-files",2343697626).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$)),path_10489__$2));
}
})()))
{try{lt.util.load.js.call(null,path_10489__$2,true);
lt.object.update_BANG_.call(null,this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","loaded-files","lt.objs.plugins/loaded-files",2343697626)], null),((function (seq__10472,chunk__10473,count__10474,i__10475,path_10489__$2,path__$1,seq__10472__$1,temp__4092__auto__){
return (function (p1__10461_SHARP_){return cljs.core.conj.call(null,(function (){var or__3408__auto__ = p1__10461_SHARP_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.PersistentHashSet.EMPTY;
}
})(),path_10489__$2);
});})(seq__10472,chunk__10473,count__10474,i__10475,path_10489__$2,path__$1,seq__10472__$1,temp__4092__auto__))
);
}catch (e10477){if((e10477 instanceof Error))
{var e_10490 = e10477;console.error([cljs.core.str("Error loading JS file: "),cljs.core.str(path_10489__$2),cljs.core.str(" : "),cljs.core.str(e_10490)].join(''));
console.error(e_10490.stack);
} else
{if((e10477 instanceof global.Error))
{var e_10491 = e10477;console.error([cljs.core.str("Error loading JS file: "),cljs.core.str(path_10489__$2),cljs.core.str(" : "),cljs.core.str(e_10491)].join(''));
console.error(e_10491.stack);
} else
{if(new cljs.core.Keyword(null,"else","else",1017020587))
{throw e10477;
} else
{}
}
}
}} else
{}
{
var G__10492 = cljs.core.next.call(null,seq__10472__$1);
var G__10493 = null;
var G__10494 = 0;
var G__10495 = 0;
seq__10472 = G__10492;
chunk__10473 = G__10493;
count__10474 = G__10494;
i__10475 = G__10495;
continue;
}
}
} else
{return null;
}
}
break;
}
}finally {lt.util.load._STAR_force_reload_STAR_ = _STAR_force_reload_STAR_10471;
lt.objs.plugins._STAR_plugin_dir_STAR_ = _STAR_plugin_dir_STAR_10470;
}});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","load-js","lt.objs.plugins/load-js",3701155451),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__load_js,new cljs.core.Keyword(null,"desc","desc",1016984067),"App: Load a javascript file",new cljs.core.Keyword(null,"params","params",4313443576),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1116631654),"path"], null)], null),new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"object.instant-load","object.instant-load",4025433875),null], null), null),new cljs.core.Keyword(null,"type","type",1017479852),new cljs.core.Keyword(null,"user","user",1017503549));
lt.objs.plugins.__BEH__load_css = (function __BEH__load_css(this$,path){var path__$1 = lt.objs.plugins.adjust_path.call(null,path);if(cljs.core.truth_((function (){var or__3408__auto__ = lt.util.load._STAR_force_reload_STAR_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.not.call(null,cljs.core.get.call(null,new cljs.core.Keyword("lt.objs.plugins","loaded-files","lt.objs.plugins/loaded-files",2343697626).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$)),path__$1));
}
})()))
{lt.object.update_BANG_.call(null,this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","loaded-files","lt.objs.plugins/loaded-files",2343697626)], null),(function (p1__10496_SHARP_){return cljs.core.conj.call(null,(function (){var or__3408__auto__ = p1__10496_SHARP_;if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return cljs.core.PersistentHashSet.EMPTY;
}
})(),path__$1);
}));
return lt.util.load.css.call(null,path__$1);
} else
{return null;
}
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","load-css","lt.objs.plugins/load-css",934792943),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__load_css,new cljs.core.Keyword(null,"desc","desc",1016984067),"App: Load a css file",new cljs.core.Keyword(null,"params","params",4313443576),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1116631654),"path"], null)], null),new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"object.instant","object.instant",773332388),null], null), null),new cljs.core.Keyword(null,"type","type",1017479852),new cljs.core.Keyword(null,"user","user",1017503549));
lt.objs.plugins.__BEH__load_keymap = (function __BEH__load_keymap(this$,path){var path__$1 = lt.objs.plugins.adjust_path.call(null,path);if(cljs.core.truth_(new cljs.core.Keyword("lt.objs.plugins","keymaps","lt.objs.plugins/keymaps",4718281889).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$))))
{return lt.object.update_BANG_.call(null,this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","keymaps","lt.objs.plugins/keymaps",4718281889)], null),cljs.core.conj,path__$1);
} else
{return lt.object.merge_BANG_.call(null,this$,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("lt.objs.plugins","keymaps","lt.objs.plugins/keymaps",4718281889),cljs.core.PersistentHashSet.fromArray([path__$1], true)], null));
}
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","load-keymap","lt.objs.plugins/load-keymap",1368994999),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__load_keymap,new cljs.core.Keyword(null,"desc","desc",1016984067),"App: Load a keymap file",new cljs.core.Keyword(null,"params","params",4313443576),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"label","label",1116631654),"path"], null)], null),new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"object.instant","object.instant",773332388),null], null), null),new cljs.core.Keyword(null,"type","type",1017479852),new cljs.core.Keyword(null,"user","user",1017503549));
lt.objs.plugins.__BEH__check_for_plugin_file = (function __BEH__check_for_plugin_file(this$){var path = new cljs.core.Keyword(null,"path","path",1017337751).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"info","info",1017141280).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,this$)));var plugin_edn = (function (){var or__3408__auto__ = lt.objs.files.walk_up_find.call(null,path,"plugin.json");if(cljs.core.truth_(or__3408__auto__))
{return or__3408__auto__;
} else
{return lt.objs.files.walk_up_find.call(null,path,"plugin.edn");
}
})();if(cljs.core.truth_(plugin_edn))
{lt.object.merge_BANG_.call(null,this$,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("lt.objs.plugins","plugin-path","lt.objs.plugins/plugin-path",2063828362),lt.objs.files.parent.call(null,plugin_edn)], null));
return lt.object.add_tags.call(null,this$,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"plugin.file","plugin.file",1865693897)], null));
} else
{return null;
}
});
lt.object.behavior_STAR_.call(null,new cljs.core.Keyword("lt.objs.plugins","check-for-plugin-file","lt.objs.plugins/check-for-plugin-file",3384140800),new cljs.core.Keyword(null,"reaction","reaction",4441361819),lt.objs.plugins.__BEH__check_for_plugin_file,new cljs.core.Keyword(null,"desc","desc",1016984067),"Plugin: Determine if this is a plugin file",new cljs.core.Keyword(null,"triggers","triggers",2516997421),new cljs.core.PersistentHashSet(null, new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"create","create",3956577390),null], null), null));
lt.object.tag_behaviors.call(null,new cljs.core.Keyword(null,"app","app",1014001043),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword("lt.objs.plugins","init-plugins","lt.objs.plugins/init-plugins",4096325174),new cljs.core.Keyword("lt.objs.plugins","plugin-behavior-diffs","lt.objs.plugins/plugin-behavior-diffs",1511349728),new cljs.core.Keyword("lt.objs.plugins","plugin-keymap-diffs","lt.objs.plugins/plugin-keymap-diffs",4431416675)], null));
